<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#ff6b35">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="MathUp">
<meta name="description" content="Matematica 2Âª Media â€“ DSA Friendly â€“ by Valerio Spiga">
<link rel="manifest" id="pwa-manifest">
<!-- Apple Touch Icons - tutti i formati necessari per iOS -->
<link rel="apple-touch-icon" sizes="180x180" href="data:image/png;base64,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">
<link rel="apple-touch-icon" sizes="180x180" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAAHRUlEQVR42u3dwXnbOBCGYQCPbj6nBzewuW89mx7ybA9OPbk7DbiHnHPmXjaOLVEWSQGDf2a+uSeWwJe/BhAIlUJRFEVRFEVR1J6qDMH9tfzz19Ltgnz7keKaLMuy1ForoIPAzQx9WZallFIAnQRvdOTLsizlpZbyuHRHDWhHgCMAf8VcCqBB7B/3O9ADUFcQJ5j5i+C+wAxoIHuFvYp5AOoKYnADGsjA7oW5M+oK5Dvr08P9/8fPX6FhA1oRcg+4DqD3gv37y5NSSrmJ+Q3qd6/lAPAKZiHAIsD3oH4H9229dKD1uP5ffwS9AlkY8GTga7AvAL9MIPQG+jnuCuSH4r6MYW/qiQ1QryV1TYk5AmJj3FKoP5hAViAD+yjsKahvrIbUFJgzQTaAfYHaopf+v2++tfJRQ2PODHkwbNMWZMcadQUysKVbkJ1fuNRQmIE8BfYw1Ae+PWxgTlodx+vtdau11mtfiIzGLAX6MOZPD2C+B3WnsVPZENbcY6Zk0loB9YkWg3odzw599exvEU/uMAN5fFILbGctL/XQ2R0NzFSkcW5gpiKNdwMzZT7uj0vpsrSnNikEc57J4ivk8mc/xoh9IGagD6UzmH2hfnpex3llY9EI2CcwU8OS+ndb8eXzq4O1p2Cuwj6w0nECM9Ud9Rnkcw/XnlnskdgVzNTuuob66fkq5At4Gx7EPXLsbgUz1RX1njQdcBaIzm47MPtrPwRrCOjd6QzmlKhHbGZqYKYioW5TMVNUZzfN891N0U9fTDRpNTrX1+/7/82/f8d473eufPRY9ahgNsYbHflk1KdCaQC+9beipLh6y5EinS0hR0juiSltm9CeMCshvva6VHH33HJqmdAh01kVsrfUnpTSDczOMau+7klfuDAp9Ax57T0knzw2k7tHOZ0jYFZ9PxNSOm9CR4NMWh9L6BDpHBmz2vs0TumW7hbOgjnp+20j7xa5dM6GWeV9G6Z046Ly/lP30C7TOTtmhXEw8rAZtNvN+2AOMR5b/TUuHqjTtRwuJ4Ng1hsfg8lh42KBmkmhcjqDWXu8Bvu4CZonuSlPk8NYLQfpnH7cTqkvyoZDBV8PIFSpLa/5yOv++j3EZqbWtd2IeDTBl8/bEWV4HQJ99EcuY7QcFh+ZMzFZ/e0ArUcDszhq67/pHDWPYB0FNrq3jtJeqCS0i/55ZpqMBDcbs8W4DuqjG/e0GDySOXkPHQk1mBODVpq83Lukprgk53RySELPTmtSeTxo+f0byumxB6g6ZvGUXnPaZ9mOk/jXoV5b2iOV/7jpfKgjLYd1WoOZHjoMajADOsTs2/PGImfjTUJTsROaJ1TOSmk/9NOz3v7syXXulYT2ghrIm4rddntBWffCQA7cQytMUCyBqWB2NDGk5VCFRjLTcoRoQYBMQjNZowCtiJqbA9AUBWgK0BQFaIpyCbrzJm0qSQ1wQ0JToYovVnoVS2700BSVG3TCH2Nn3EloioTWnLFSgWuQlwvQ9duPymhTXurcKy0HRcvBBIUJYQ7Q9NHUZCe0HBQtB0W5Ai2/0kEfzThfcdo/oemjqYk+/LYcpDTjawaalKYmuWBSSMWfFLqYGNJ2pB7Xaz7HJTRtBzXBg/+Wg5RmPM1AW6U0qLXH0fDTuh3pUyhKsX8upZSbYLv8RIXV7xg6/Tlf0rkf6MZFoSKNW7vnblDsoSihMk7neAlNSqcfr+b5bgW18DhN+lTeBNrlageow43PFoe2LYf1XQvqOeMycc7Uet4doAbzqOu71V/jIoKZSaHHj6TsqC3ev8Dy7C7QXSeHoAbzAHdzWw5Qg3l2yxFiw1IW1AHe515v80/w//nLbvPS2sWOuKHJErLYtoZmcddID0q0tA6E+Ygznd9YmZXUUdLa+sYU3XDWLO8e+UHymtYBMR/1dTfKLg8AnNespH5bHtJ6xg0ojFmr5VBpP9awKOGe+SniYF97l7ZhSEqrJLVKas9uh4ww39vKav/wpkJSf4RqJHClft7RE0fdJnbDUloxqXunuPJk1BBzj4WGrisVoA5WzjCX4mn7KA/aMt7WoIfv8wB1SMw93QwBOLT1oAUJFRi9Q7B5eJGkNZjj9dCgZhxntRymrQctiEvIoz7Fm8cXTVqDeUpCT0lq0lr6xh8dcmYJao4a2HKfYBaf2KbPB05BnR22SCtm1X6eUl3UTLCTzinMn+CeltJZElsQsuXiwJQjCSRQR8ItnMbWx15MO2NDCrVX2OJtxYwzXKYeGiOHWh24p432kw4kkjgFSRr2TOAOJ3azT9aSOdbLBepR0IOsSCgcEyd1Tp1b1JTMmYeNQaEiXbfG4FCRrpc0HloQILtPaNIazGFBg5rrEarloAUBcriEJq0Z97AJTVoDOSxoYAPZfctBG8J4hk9o0hrIYUEDm0+40B/XwM7XqqXpP8GdY76RbkKVEXamiXPqFYLIuLOu/rDkFQg3S5iAdg0cwIB2ixy8gHYJHbgURVEURVHy9R88JKQ7u79jIAAAAABJRU5ErkJggg==">
<link rel="apple-touch-icon" sizes="152x152" href="data:image/png;base64,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">
<link rel="apple-touch-icon" sizes="144x144" href="data:image/png;base64,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">
<link rel="apple-touch-icon" sizes="128x128" href="data:image/png;base64,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">
<link rel="apple-touch-icon" sizes="96x96" href="data:image/png;base64,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">
<link rel="apple-touch-icon" sizes="72x72" href="data:image/png;base64,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">
<!-- Favicon standard -->
<link rel="icon" type="image/png" href="data:image/png;base64,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">
<link rel="icon" type="image/png" href="data:image/png;base64,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">
<link rel="shortcut icon" href="data:image/png;base64,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">
<title>MathUp â€“ Matematica DSA</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Nunito+Sans:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #fef9f0;
  --card: #ffffff;
  --primary: #ff6b35;
  --primary-light: #fff0eb;
  --primary-dark: #e55527;
  --accent: #4ecdc4;
  --accent-light: #e8faf9;
  --purple: #8b5cf6;
  --purple-light: #f5f3ff;
  --green: #22c55e;
  --green-light: #f0fdf4;
  --yellow: #f59e0b;
  --yellow-light: #fffbeb;
  --blue: #3b82f6;
  --blue-light: #eff6ff;
  --red: #ef4444;
  --text: #1e293b;
  --text-light: #64748b;
  --border: #e2e8f0;
  --shadow: 0 4px 24px rgba(0,0,0,0.07);
  --shadow-lg: 0 12px 40px rgba(0,0,0,0.12);
  --radius: 20px;
  --font: 'Nunito', sans-serif;
  --font-body: 'Nunito Sans', sans-serif;
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html{scroll-behavior:smooth}
body{
  font-family:var(--font-body);
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  font-size:17px;
  line-height:1.7;
  overscroll-behavior:none;
}

/* â”€â”€ SPLASH â”€â”€ */
#splash{
  position:fixed;inset:0;
  background:linear-gradient(135deg,#ff6b35 0%,#ff8c42 60%,#ffa05c 100%);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:1000;transition:opacity 0.5s;
}
#splash .splash-logo{font-family:var(--font);font-weight:900;font-size:52px;color:white;letter-spacing:-1px}
#splash .splash-logo span{color:rgba(255,255,255,0.6)}
#splash p{color:rgba(255,255,255,0.85);font-family:var(--font);font-weight:600;font-size:16px;margin-top:10px}
#splash .dot-loader{display:flex;gap:8px;margin-top:30px}
#splash .dot{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.7);animation:bounce 0.8s infinite alternate}
#splash .dot:nth-child(2){animation-delay:0.2s}
#splash .dot:nth-child(3){animation-delay:0.4s}
@keyframes bounce{to{transform:translateY(-10px);opacity:1}from{opacity:0.4}}

/* â”€â”€ HEADER â”€â”€ */
header{
  background:linear-gradient(135deg,var(--primary) 0%,#ff8c42 100%);
  padding:14px 20px 14px;
  padding-top:calc(14px + env(safe-area-inset-top,0px));
  display:flex;align-items:center;gap:12px;
  box-shadow:0 4px 20px rgba(255,107,53,0.3);
  position:sticky;top:0;z-index:50;
}
.logo{font-family:var(--font);font-weight:900;font-size:24px;color:white;letter-spacing:-0.5px;text-decoration:none}
.logo span{color:rgba(255,255,255,0.55)}
.header-right{margin-left:auto;display:flex;align-items:center;gap:10px}
.pts-badge{
  background:rgba(255,255,255,0.2);color:white;
  font-family:var(--font);font-weight:800;font-size:14px;
  padding:6px 14px;border-radius:50px;
  border:2px solid rgba(255,255,255,0.3);
  backdrop-filter:blur(4px);
}
.settings-btn{
  background:rgba(255,255,255,0.2);border:none;
  color:white;font-size:18px;width:36px;height:36px;
  border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;
}

/* â”€â”€ BOTTOM NAV â”€â”€ */
.bottom-nav{
  position:fixed;bottom:0;left:0;right:0;
  background:white;
  padding:8px 4px calc(8px + var(--safe-bottom));
  display:flex;justify-content:space-around;
  box-shadow:0 -4px 20px rgba(0,0,0,0.08);
  z-index:50;border-top:1px solid var(--border);
}
.nav-item{
  display:flex;flex-direction:column;align-items:center;gap:3px;
  cursor:pointer;padding:6px 10px;border-radius:14px;
  transition:all 0.2s;flex:1;max-width:72px;border:none;background:none;
}
.nav-item .ni{font-size:20px;transition:transform 0.2s}
.nav-item .nl{font-family:var(--font);font-weight:700;font-size:10px;color:var(--text-light);line-height:1.2;text-align:center}
.nav-item.active{background:var(--primary-light)}
.nav-item.active .ni{transform:scale(1.2)}
.nav-item.active .nl{color:var(--primary)}

/* â”€â”€ MAIN â”€â”€ */
main{padding:20px 16px calc(100px + var(--safe-bottom));max-width:680px;margin:0 auto}

/* â”€â”€ CARDS â”€â”€ */
.card{
  background:var(--card);border-radius:var(--radius);
  padding:24px;margin-bottom:20px;
  box-shadow:var(--shadow);
}
.card h2{
  font-family:var(--font);font-weight:900;font-size:20px;
  margin-bottom:14px;display:flex;align-items:center;gap:10px;
}
.card p{font-size:16px;line-height:1.8;margin-bottom:12px}
.card p:last-child{margin-bottom:0}

/* â”€â”€ VISUAL BLOCKS â”€â”€ */
.vb{
  border-radius:14px;padding:20px;margin:18px 0;
  border-left:5px solid;
}
.vb-orange{background:var(--primary-light);border-color:var(--primary)}
.vb-teal{background:var(--accent-light);border-color:var(--accent)}
.vb-purple{background:var(--purple-light);border-color:var(--purple)}
.vb-green{background:var(--green-light);border-color:var(--green)}
.vb-yellow{background:var(--yellow-light);border-color:var(--yellow)}
.vb-blue{background:var(--blue-light);border-color:var(--blue)}
.vb h3{font-family:var(--font);font-weight:800;font-size:16px;margin-bottom:10px}

/* â”€â”€ FORMULA BOX â”€â”€ */
.formula{
  font-family:var(--font);font-weight:900;font-size:22px;
  text-align:center;padding:16px 24px;border-radius:50px;
  margin:12px auto;display:inline-block;letter-spacing:0.5px;
}
.formula-orange{background:var(--primary);color:white}
.formula-purple{background:var(--purple);color:white}
.formula-blue{background:var(--blue);color:white}
.formula-green{background:var(--green);color:white}

/* â”€â”€ SLIDERS â”€â”€ */
.slider-row{margin:12px 0}
.slider-row label{font-family:var(--font);font-weight:700;font-size:14px;color:var(--text-light);display:block;margin-bottom:6px}
input[type=range]{
  width:100%;height:8px;-webkit-appearance:none;
  background:#e2e8f0;border-radius:4px;outline:none;cursor:pointer;
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;width:28px;height:28px;border-radius:50%;
  background:var(--primary);border:3px solid white;
  box-shadow:0 2px 8px rgba(255,107,53,0.35);cursor:pointer;
}

/* â”€â”€ CANVAS â”€â”€ */
canvas{
  border-radius:14px;background:white;
  border:2px solid var(--border);max-width:100%;display:block;
}

/* â”€â”€ STEP PILLS â”€â”€ */
.pills{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
.pill{
  padding:7px 16px;border-radius:50px;
  font-family:var(--font);font-weight:700;font-size:13px;
  background:#f1f5f9;color:var(--text-light);
  cursor:pointer;border:2px solid transparent;transition:all 0.2s;
}
.pill.active{background:var(--primary);color:white;border-color:var(--primary)}
.pill:hover:not(.active){border-color:var(--primary);color:var(--primary)}

/* â”€â”€ NUMBER LINE â”€â”€ */
.nl-scroll{overflow-x:auto;padding:16px 0}
.nl-track{
  display:flex;align-items:center;
  min-width:540px;position:relative;padding:0 10px;
}
.nl-axis{position:absolute;top:50%;left:10px;right:10px;height:3px;background:var(--text);transform:translateY(-50%)}
.nl-item{
  display:flex;flex-direction:column;align-items:center;
  flex:1;position:relative;z-index:2;cursor:pointer;
}
.nl-dot{
  width:38px;height:38px;border-radius:50%;background:white;
  border:3px solid var(--text);display:flex;align-items:center;justify-content:center;
  font-family:var(--font);font-weight:800;font-size:14px;
  transition:all 0.2s;margin-bottom:6px;
}
.nl-item.neg .nl-dot{border-color:var(--red);color:var(--red)}
.nl-item.zero .nl-dot{border-color:var(--text);background:var(--text);color:white;width:44px;height:44px}
.nl-item.pos .nl-dot{border-color:var(--green);color:var(--green)}
.nl-item:hover .nl-dot{transform:scale(1.25);box-shadow:0 0 0 5px rgba(0,0,0,0.08)}
.nl-lbl{font-size:10px;font-family:var(--font);font-weight:700;color:var(--text-light)}

/* â”€â”€ FRACTION VIS â”€â”€ */
.frac-parts{display:flex;flex-wrap:wrap;gap:5px;margin:14px 0}
.fp{
  width:46px;height:46px;border-radius:10px;
  border:2px solid var(--border);background:#f8fafc;
  transition:all 0.3s;cursor:default;
}
.fp.on{background:var(--primary);border-color:var(--primary)}

/* â”€â”€ EXERCISE ZONE â”€â”€ */
.ex-zone{
  background:linear-gradient(135deg,#f8fafc,#f0f4ff);
  border-radius:var(--radius);padding:24px;
  margin-top:4px;border:2px solid var(--border);
}
.ex-zone h3{
  font-family:var(--font);font-weight:900;font-size:17px;
  color:var(--purple);margin-bottom:16px;
  display:flex;align-items:center;gap:8px;
}
.q-card{background:white;border-radius:16px;padding:22px;box-shadow:0 2px 12px rgba(0,0,0,0.05)}
.q-num{
  font-family:var(--font);font-weight:800;font-size:11px;
  color:white;background:var(--purple);padding:3px 10px;
  border-radius:50px;display:inline-block;margin-bottom:12px;
  letter-spacing:0.5px;
}
.q-text{
  font-family:var(--font);font-weight:700;font-size:18px;
  color:var(--text);margin-bottom:20px;line-height:1.5;
}
/* Visual question support */
.q-visual{
  background:var(--blue-light);border-radius:12px;padding:14px;
  margin-bottom:16px;font-family:var(--font);font-weight:700;
  font-size:15px;color:var(--blue);line-height:1.7;
  border-left:4px solid var(--blue);
}
.opts{
  display:grid;grid-template-columns:repeat(2,1fr);gap:10px;
}
.opts.four-opts{grid-template-columns:repeat(2,1fr)}
.opt-btn{
  padding:18px 10px;border-radius:14px;border:3px solid var(--border);
  background:white;cursor:pointer;
  font-family:var(--font);font-weight:800;font-size:18px;
  color:var(--text);transition:all 0.2s;text-align:center;line-height:1.3;
  -webkit-user-select:none;user-select:none;
}
.opt-btn:active{transform:scale(0.96)}
.opt-btn:hover:not(.locked){border-color:var(--primary);background:var(--primary-light);transform:scale(1.03)}
.opt-btn.correct{background:var(--green-light)!important;border-color:var(--green)!important;color:var(--green)!important;animation:pop 0.35s ease}
.opt-btn.wrong{background:#fef2f2!important;border-color:var(--red)!important;color:var(--red)!important;animation:shake 0.35s ease}
.opt-btn.locked{cursor:default}
@keyframes pop{0%{transform:scale(1)}40%{transform:scale(1.12)}100%{transform:scale(1)}}
@keyframes shake{0%{transform:translateX(0)}20%{transform:translateX(-8px)}60%{transform:translateX(8px)}100%{transform:translateX(0)}}

.feedback{
  margin-top:14px;padding:14px 18px;border-radius:12px;
  font-family:var(--font);font-weight:800;font-size:15px;
  display:none;align-items:flex-start;gap:10px;line-height:1.5;
}
.feedback.show{display:flex}
.feedback.ok{background:var(--green-light);color:#15803d}
.feedback.ko{background:#fef2f2;color:#b91c1c}

/* â”€â”€ HINT â”€â”€ */
.hint-btn{
  display:inline-flex;align-items:center;gap:6px;
  background:none;border:2px solid var(--yellow);
  border-radius:50px;padding:7px 16px;
  cursor:pointer;font-family:var(--font);font-weight:700;
  font-size:13px;color:#92400e;margin-top:14px;
  transition:all 0.2s;
}
.hint-btn:hover{background:var(--yellow-light)}
.hint-box{
  display:none;margin-top:10px;padding:14px 16px;
  background:var(--yellow-light);border:2px dashed var(--yellow);
  border-radius:12px;font-family:var(--font);font-weight:600;
  font-size:14px;color:#92400e;line-height:1.6;
}
.hint-box.show{display:block}

/* â”€â”€ NEXT BTN â”€â”€ */
.next-btn{
  display:inline-flex;align-items:center;gap:8px;
  background:linear-gradient(135deg,var(--primary),#ff8c42);
  color:white;border:none;border-radius:50px;
  padding:14px 28px;font-family:var(--font);font-weight:800;
  font-size:16px;cursor:pointer;margin-top:18px;
  box-shadow:0 4px 16px rgba(255,107,53,0.35);
  transition:all 0.2s;
}
.next-btn:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(255,107,53,0.5)}

/* â”€â”€ PROGRESS â”€â”€ */
.q-progress{
  display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap;
}
.q-dot{
  width:28px;height:28px;border-radius:50%;
  background:var(--border);font-family:var(--font);
  font-weight:800;font-size:11px;display:flex;align-items:center;
  justify-content:center;color:white;transition:all 0.3s;
}
.q-dot.done-ok{background:var(--green)}
.q-dot.done-ko{background:var(--red)}
.q-dot.current{background:var(--primary);transform:scale(1.15)}

/* â”€â”€ TOOLS FLOATING â”€â”€ */
.tools-row{
  display:flex;flex-wrap:wrap;gap:8px;
  padding:12px 16px;background:var(--card);
  border-bottom:1px solid var(--border);
  position:sticky;top:58px;z-index:40;
  overflow-x:auto;
  padding-top:calc(12px + env(safe-area-inset-top,0px) * 0);
}
.tool-chip{
  display:inline-flex;align-items:center;gap:5px;
  padding:8px 14px;border-radius:50px;
  background:var(--accent-light);border:2px solid var(--accent);
  font-family:var(--font);font-weight:700;font-size:13px;
  color:#0f766e;cursor:pointer;white-space:nowrap;
  transition:all 0.2s;flex-shrink:0;
}
.tool-chip:hover{background:var(--accent);color:white;transform:scale(1.04)}

/* â”€â”€ MODAL â”€â”€ */
.overlay{
  position:fixed;inset:0;background:rgba(0,0,0,0.55);
  z-index:200;display:none;align-items:flex-end;justify-content:center;
  padding:0;backdrop-filter:blur(6px);
}
.overlay.show{display:flex}
.modal{
  background:white;border-radius:28px 28px 0 0;
  padding:28px 24px calc(24px + var(--safe-bottom));
  width:100%;max-width:560px;
  box-shadow:0 -8px 40px rgba(0,0,0,0.18);
  animation:slideUp 0.3s cubic-bezier(0.34,1.56,0.64,1);
  max-height:88vh;overflow-y:auto;
}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-handle{width:40px;height:4px;background:#ddd;border-radius:2px;margin:0 auto 20px}
.modal h3{font-family:var(--font);font-weight:900;font-size:20px;margin-bottom:18px}
.modal-close{
  width:100%;margin-top:20px;padding:14px;
  background:var(--primary);color:white;border:none;border-radius:14px;
  font-family:var(--font);font-weight:800;font-size:16px;cursor:pointer;
  transition:all 0.2s;
}
.modal-close:hover{background:var(--primary-dark)}

/* â”€â”€ CALCULATOR â”€â”€ */
.calc{background:#1e293b;border-radius:20px;padding:18px;max-width:300px;margin:0 auto}
.calc-disp{
  background:#0f172a;border-radius:12px;padding:14px 18px;
  text-align:right;font-family:var(--font);font-weight:800;
  font-size:30px;color:#f8fafc;margin-bottom:14px;min-height:58px;
  word-break:break-all;
}
.calc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.cb{
  padding:16px 8px;border-radius:12px;border:none;
  font-family:var(--font);font-weight:800;font-size:18px;
  cursor:pointer;transition:all 0.15s;background:#334155;color:#f8fafc;
}
.cb:active{transform:scale(0.93)}
.cb.op{background:var(--primary);color:white}
.cb.eq{background:var(--accent);color:white;grid-column:span 2}
.cb.clr{background:var(--red);color:white}
.cb.z{grid-column:span 2}

/* â”€â”€ PITA TABLE â”€â”€ */
.pt{border-collapse:collapse;width:100%;font-family:var(--font);font-weight:700;font-size:13px;border-radius:12px;overflow:hidden}
.pt th{background:var(--purple);color:white;padding:8px 5px;text-align:center}
.pt td{padding:7px 4px;text-align:center;border:1px solid #f1f5f9;cursor:pointer;transition:background 0.15s}
.pt td:hover{background:var(--purple-light)}
.pt tr:nth-child(even) td{background:#fafafa}
.pt tr:nth-child(even) td:hover{background:var(--purple-light)}
.pt td.diag{background:var(--purple-light);color:var(--purple);font-weight:900}

/* â”€â”€ FORMULE SHEET â”€â”€ */
.form-row{
  display:flex;align-items:center;gap:12px;
  padding:12px 0;border-bottom:1px solid var(--border);
  font-family:var(--font);
}
.form-row:last-child{border-bottom:none}
.form-icon{font-size:26px;flex-shrink:0;width:36px;text-align:center}
.form-content .name{font-weight:800;font-size:14px;color:var(--text-light)}
.form-content .f{font-weight:800;font-size:16px;color:var(--text);margin-top:2px}
.form-content .inv{font-size:13px;color:var(--purple);font-weight:700;margin-top:2px}

/* â”€â”€ STATS PAGE â”€â”€ */
.stat-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-bottom:20px}
.stat-box{
  background:white;border-radius:16px;padding:18px;
  box-shadow:var(--shadow);text-align:center;
}
.stat-box .sv{font-family:var(--font);font-weight:900;font-size:34px}
.stat-box .sl{font-family:var(--font);font-weight:700;font-size:12px;color:var(--text-light);margin-top:4px}
.stars-row{display:flex;gap:4px;justify-content:center;font-size:26px;margin:6px 0}

/* â”€â”€ ACCESS BAR â”€â”€ */
.access-bar{display:flex;gap:8px;flex-wrap:wrap;margin-top:16px}
.ac-btn{
  padding:8px 16px;border-radius:50px;border:2px solid var(--border);
  background:white;cursor:pointer;font-family:var(--font);font-weight:700;
  font-size:13px;color:var(--text-light);transition:all 0.2s;
  display:flex;align-items:center;gap:5px;
}
.ac-btn.on{background:var(--primary);border-color:var(--primary);color:white}
.ac-btn:hover{transform:scale(1.04)}

/* â”€â”€ ACCESSIBILITY MODES â”€â”€ */
body.large-text{font-size:20px}
body.large-text .opt-btn{font-size:22px;padding:22px 10px}
body.large-text .q-text{font-size:22px}
body.large-text .formula{font-size:26px}
body.high-contrast{
  --bg:#0a0a0a;--card:#1a1a1a;--text:#ffffff;--text-light:#aaaaaa;
  --border:#333;--primary-light:#2a1200;--accent-light:#001a18;
  --purple-light:#180033;--green-light:#001a0d;--yellow-light:#1a1500;
  --blue-light:#001226;
}
body.high-contrast .opt-btn{background:#1a1a1a!important;color:white!important}
body.dsa-font *{letter-spacing:0.08em!important;word-spacing:0.15em!important;line-height:2.1!important}

/* â”€â”€ PROGRESS BAR â”€â”€ */
.prog-bar-wrap{height:6px;background:var(--border);border-radius:3px;margin-bottom:16px;overflow:hidden}
.prog-bar-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--yellow));border-radius:3px;transition:width 0.5s ease}

/* â”€â”€ CONTENT PAGES â”€â”€ */
.page{display:none}
.page.active{display:block}

/* â”€â”€ HOME PAGE â”€â”€ */
.home-hero{
  background:linear-gradient(135deg,var(--primary) 0%,#ff8c42 50%,#ffa05c 100%);
  border-radius:var(--radius);padding:28px 24px;margin-bottom:20px;
  color:white;position:relative;overflow:hidden;
}
.home-hero::after{
  content:'ðŸ§ ';font-size:80px;
  position:absolute;right:-10px;bottom:-10px;opacity:0.25;
  transform:rotate(15deg);
}
.home-hero h1{font-family:var(--font);font-weight:900;font-size:26px;margin-bottom:8px}
.home-hero p{font-size:15px;opacity:0.9;line-height:1.6;max-width:300px}
.topic-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.topic-card{
  background:var(--card);border-radius:18px;padding:20px;
  box-shadow:var(--shadow);cursor:pointer;border:3px solid transparent;
  transition:all 0.25s;display:flex;flex-direction:column;gap:8px;
}
.topic-card:hover,.topic-card:active{transform:translateY(-3px);box-shadow:var(--shadow-lg)}
.topic-card .tc-icon{font-size:32px}
.topic-card .tc-name{font-family:var(--font);font-weight:800;font-size:14px;line-height:1.3}
.topic-card .tc-count{font-size:12px;color:var(--text-light);font-family:var(--font);font-weight:600}
.topic-card .tc-bar{height:4px;border-radius:2px;background:var(--border);margin-top:4px}
.topic-card .tc-fill{height:100%;border-radius:2px;transition:width 0.5s}

/* â”€â”€ AUTHOR â”€â”€ */
.author-tag{
  text-align:center;padding:16px;
  font-family:var(--font);font-size:13px;font-weight:600;
  color:var(--text-light);
}
.author-tag strong{color:var(--primary)}

/* â”€â”€ INSTALL BANNER â”€â”€ */
#install-banner{
  display:none;position:fixed;bottom:calc(70px + var(--safe-bottom));
  left:16px;right:16px;
  background:linear-gradient(135deg,var(--purple),#7c3aed);
  color:white;border-radius:18px;padding:16px 20px;
  box-shadow:0 8px 32px rgba(139,92,246,0.4);
  z-index:60;animation:slideUp 0.4s ease;
}
#install-banner.show{display:flex;align-items:center;gap:12px}
#install-banner p{flex:1;font-family:var(--font);font-weight:700;font-size:14px;line-height:1.4}
.install-btn{
  background:white;color:var(--purple);border:none;border-radius:50px;
  padding:10px 18px;font-family:var(--font);font-weight:800;font-size:13px;
  cursor:pointer;white-space:nowrap;flex-shrink:0;
}
.install-x{background:none;border:none;color:rgba(255,255,255,0.6);font-size:20px;cursor:pointer;flex-shrink:0;padding:0 4px}

/* â”€â”€ SECTION HEADER â”€â”€ */
.sec-header{
  display:flex;align-items:center;gap:12px;margin-bottom:20px;
}
.sec-back{
  background:none;border:2px solid var(--border);border-radius:50%;
  width:40px;height:40px;cursor:pointer;font-size:18px;
  display:flex;align-items:center;justify-content:center;
  transition:all 0.2s;color:var(--text);flex-shrink:0;
}
.sec-back:hover{background:var(--primary-light);border-color:var(--primary);color:var(--primary)}
.sec-header h2{font-family:var(--font);font-weight:900;font-size:22px}

/* geom visual helpers */
.geom-result{
  font-family:var(--font);font-weight:800;font-size:20px;
  text-align:center;margin-top:14px;padding:14px;
  background:var(--purple-light);border-radius:12px;color:var(--purple);
}
</style>

<script>
// â”€â”€ Helper decimali italiani â”€â”€
function itNum(n, dec=2) {
  return parseFloat(n.toFixed(dec)).toString().replace('.', ',');
}
function itFixed(n, dec=2) {
  return n.toFixed(dec).replace('.', ',');
}

// â”€â”€ INLINE MANIFEST â”€â”€
(function(){
  const m = {"name": "MathUp \u2013 Matematica DSA", "short_name": "MathUp", "description": "Matematica 2\u00aa Media per studenti con discalculia \u2013 by Valerio Spiga", "start_url": "./", "display": "standalone", "background_color": "#ff6b35", "theme_color": "#ff6b35", "orientation": "portrait", "icons": [{"src": "data:image/png;base64,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", "sizes": "192x192", "type": "image/png", "purpose": "any maskable"}, {"src": "data:image/png;base64,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", "sizes": "512x512", "type": "image/png", "purpose": "any maskable"}], "categories": ["education"], "lang": "it"};
  const blob = new Blob([JSON.stringify(m)],{type:'application/manifest+json'});
  const url = URL.createObjectURL(blob);
  document.getElementById('pwa-manifest').href = url;
})();

// â”€â”€ INLINE SERVICE WORKER â”€â”€
(function(){
  if(!('serviceWorker' in navigator)) return;
  const sw = `const CACHE='mathup-v2';
const ASSETS=['./'];
self.addEventListener('install',e=>{e.waitUntil(caches.open(CACHE).then(c=>c.addAll(ASSETS).catch(()=>{})));self.skipWaiting();});
self.addEventListener('activate',e=>{e.waitUntil(caches.keys().then(keys=>Promise.all(keys.filter(k=>k!==CACHE).map(k=>caches.delete(k)))));self.clients.claim();});
self.addEventListener('fetch',e=>{e.respondWith(caches.match(e.request).then(cached=>cached||fetch(e.request).catch(()=>new Response('',{status:200}))));});`;
  const blob = new Blob([sw],{type:'application/javascript'});
  const url = URL.createObjectURL(blob);
  navigator.serviceWorker.register(url, {scope:'./'}).then(()=>console.log('SW ok')).catch(e=>console.log('SW err',e));
})();
</script>
</head>
<body>

<!-- SPLASH -->
<div id="splash">
  <div class="splash-logo">Math<span>Up</span> ðŸš€</div>
  <p>Matematica 2Âª Media â€“ DSA Friendly</p>
  <div class="dot-loader">
    <div class="dot"></div><div class="dot"></div><div class="dot"></div>
  </div>
</div>

<!-- HEADER -->
<header id="mainHeader">
  <span class="logo">Math<span>Up</span></span>
  <div class="header-right">
    <span class="pts-badge" id="ptsBadge">â­ 0 pt</span>
    <button class="settings-btn" onclick="showPage('settings')" title="Impostazioni">âš™ï¸</button>
  </div>
</header>

<!-- TOOLS ROW -->
<div class="tools-row" id="toolsRow">
  <button class="tool-chip" onclick="openModal('mCalc')">ðŸ”¢ Calcolatrice</button>
  <button class="tool-chip" onclick="openModal('mPita')">âœ–ï¸ Tav. Pitagorica</button>
  <button class="tool-chip" onclick="openModal('mForm')">ðŸ“ Formule</button>
  <button class="tool-chip" onclick="openModal('mReg')">Â± Regole Segni</button>
  <button class="tool-chip" onclick="openModal('mTav')">ðŸ”¢ Tavole Numeriche</button>
  <button class="tool-chip" onclick="openModal('mPrim')">ðŸ”µ Numeri Primi</button>
</div>

<!-- MAIN -->
<main id="mainContent">

  <!-- â•â•â•â•â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page active" id="pageHome">
    <div class="home-hero">
      <h1>Ciao! Pronto a fare matematica? ðŸŽ¯</h1>
      <p>Scegli un argomento. Nessuno scrive a mano â€” si risponde sempre cliccando!</p>
    </div>
    <div class="topic-grid">
      <div class="topic-card" onclick="showTopic('numeri')" style="border-color:#ef444422" id="tc-numeri">
        <div class="tc-icon">Â±</div>
        <div class="tc-name">Numeri Relativi</div>
        <div class="tc-count" id="cnt-numeri">10 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-numeri" style="width:0%;background:#ef4444"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('frazioni')" style="border-color:#f59e0b22" id="tc-frazioni">
        <div class="tc-icon">Â½</div>
        <div class="tc-name">Frazioni</div>
        <div class="tc-count" id="cnt-frazioni">10 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-frazioni" style="width:0%;background:#f59e0b"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('geometria')" style="border-color:#3b82f622" id="tc-geometria">
        <div class="tc-icon">ðŸ”·</div>
        <div class="tc-name">Geometria & Aree</div>
        <div class="tc-count" id="cnt-geometria">22 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-geometria" style="width:0%;background:#3b82f6"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('pitagora')" style="border-color:#8b5cf622" id="tc-pitagora">
        <div class="tc-icon">ðŸ“</div>
        <div class="tc-name">Teorema di Pitagora</div>
        <div class="tc-count" id="cnt-pitagora">10 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-pitagora" style="width:0%;background:#8b5cf6"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('algebra')" style="border-color:#22c55e22" id="tc-algebra">
        <div class="tc-icon">ðŸ”¤</div>
        <div class="tc-name">Algebra</div>
        <div class="tc-count" id="cnt-algebra">10 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-algebra" style="width:0%;background:#22c55e"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('statistica')" style="border-color:#f59e0b22" id="tc-statistica">
        <div class="tc-icon">ðŸ“Š</div>
        <div class="tc-name">Statistica</div>
        <div class="tc-count" id="cnt-statistica">10 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-statistica" style="width:0%;background:#f59e0b"></div></div>
      </div>
      <div class="topic-card" onclick="showTopic('radicali')" style="border-color:#06b6d422" id="tc-radicali">
        <div class="tc-icon">âˆš</div>
        <div class="tc-name">Potenze & Radicali</div>
        <div class="tc-count" id="cnt-radicali">15 esercizi</div>
        <div class="tc-bar"><div class="tc-fill" id="fill-radicali" style="width:0%;background:#06b6d4"></div></div>
      </div>
      <div class="topic-card" onclick="showRipasso()" style="border-color:#f43f5e22;grid-column:span 2;display:flex;flex-direction:row;align-items:center;gap:16px;padding:18px" id="tc-ripasso">
        <div class="tc-icon" style="font-size:40px">ðŸŽ¯</div>
        <div style="flex:1">
          <div class="tc-name" style="font-size:16px">Ripasso Generale</div>
          <div class="tc-count">Sessioni da 20-30 domande miste su tutti gli argomenti</div>
          <div class="tc-bar" style="margin-top:8px"><div class="tc-fill" id="fill-ripasso" style="width:0%;background:#f43f5e"></div></div>
        </div>
        <div style="font-size:28px">â–¶</div>
      </div>
    </div>
    <div class="author-tag">Creato da <strong>Valerio Spiga</strong> Â· MathUp v1.0 Â· DSA Friendly ðŸ§¡</div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â• TOPIC PAGE â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="pageTopicLesson">
    <div class="sec-header">
      <button class="sec-back" onclick="showPage('home')" aria-label="Torna alla home">â†</button>
      <h2 id="topicTitle"></h2>
    </div>
    <div id="lessonContent"></div>
    <div class="ex-zone" id="exZone">
      <h3 id="exTitle">ðŸ’ª Esercitati â€” clicca la risposta!</h3>
      <div class="q-progress" id="qProgress"></div>
      <div class="prog-bar-wrap"><div class="prog-bar-fill" id="qProgBar" style="width:0%"></div></div>
      <div id="quizArea"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â• STATS â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="pageStats">
    <div class="sec-header" style="margin-bottom:20px">
      <h2>ðŸ“Š I tuoi progressi</h2>
    </div>
    <div class="stat-grid" id="statGrid"></div>
    <div class="card" id="statDetail"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â• SETTINGS â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="pageSettings">
    <div class="sec-header" style="margin-bottom:20px">
      <button class="sec-back" onclick="showPage('home')">â†</button>
      <h2>âš™ï¸ Impostazioni</h2>
    </div>
    <div class="card">
      <h2>â™¿ AccessibilitÃ </h2>
      <div class="access-bar">
        <button class="ac-btn" id="btnLarge" onclick="toggleA('large-text',this)">ðŸ”¤ Testo Grande</button>
        <button class="ac-btn" id="btnContrast" onclick="toggleA('high-contrast',this)">ðŸŒ™ Alto Contrasto</button>
        <button class="ac-btn" id="btnDSA" onclick="toggleA('dsa-font',this)">ðŸ“– Font DSA</button>
        <button class="ac-btn" id="btnSound" onclick="toggleSound(this)">ðŸ”Š Audio Attivo</button>
      </div>
    </div>
    <div class="card">
      <h2>â„¹ï¸ Informazioni</h2>
      <p><strong>MathUp</strong> Ã¨ una webapp educativa pensata per studenti di 2Âª media con discalculia e disgrafia, ispirata alle linee guida pedagogiche per i DSA (Legge 170/2010).</p>
      <p>Principi adottati: piccoli passi progressivi, risposta per clic (nessuna scrittura), strumenti compensativi sempre visibili, feedback immediato, rinforzo positivo.</p>
      <div style="background:#fef3c7;border:2px solid #f59e0b;border-radius:14px;padding:14px 16px;margin:16px 0">
        <p style="font-family:var(--font);font-weight:800;font-size:14px;color:#92400e;margin-bottom:6px">âš ï¸ Nota per genitori e insegnanti</p>
        <p style="font-family:var(--font);font-weight:600;font-size:13px;color:#78350f;line-height:1.6;margin:0">Questa app Ã¨ stata realizzata con il supporto dell'intelligenza artificiale. Nonostante la cura nella verifica dei contenuti, le informazioni e le risposte potrebbero contenere errori. <strong>Un adulto (genitore o insegnante) dovrebbe sempre supervisionare e verificare i contenuti prima dell'uso didattico.</strong></p>
      </div>
      <p style="margin-top:16px;font-family:var(--font);font-weight:800;color:var(--primary)">Autore: Valerio Spiga</p>
      <p style="font-size:14px;color:var(--text-light)">Versione 1.0 Â· 2026</p>
    </div>
    <div class="card">
      <h2>ðŸ“² Installazione su telefono</h2>
      <p><strong>ðŸ“± iPhone / iPad:</strong> apri questa pagina in Safari â†’ tocca Condividi â¬†ï¸ â†’ "Aggiungi alla schermata Home"</p>
      <p><strong>ðŸ¤– Android / Chrome:</strong> tocca i tre puntini â‹® â†’ "Aggiungi alla schermata Home" o "Installa app"</p>
      <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
        <button onclick="openModal('mIos')" style="padding:12px 20px;background:var(--primary);color:white;border:none;border-radius:12px;font-family:var(--font);font-weight:800;font-size:15px;cursor:pointer;display:flex;align-items:center;gap:8px">
          ðŸ“² Guida passo-passo iPhone
        </button>
        <button onclick="document.getElementById('install-banner').classList.add('show')" style="padding:12px 20px;background:var(--accent);color:white;border:none;border-radius:12px;font-family:var(--font);font-weight:800;font-size:15px;cursor:pointer;display:flex;align-items:center;gap:8px">
          ðŸ¤– Installa su Android
        </button>
      </div>
    </div>
    <div class="author-tag">Made with ðŸ§¡ by <strong>Valerio Spiga</strong></div>
  </div>


  <!-- â•â• PAGE RIPASSO â•â• -->
  <div class="page" id="pageRipasso">
    <div class="sec-header">
      <button class="sec-back" onclick="showPage('home')" aria-label="Torna alla home">â†</button>
      <h2>ðŸŽ¯ Ripasso Generale</h2>
    </div>

    <!-- schermata START -->
    <div id="ripassoStart" class="card" style="text-align:center;padding:28px 20px">
      <div style="font-size:56px;margin-bottom:12px">ðŸŽ¯</div>
      <h2 style="font-family:var(--font);font-weight:900;font-size:22px;margin-bottom:8px">Ripasso Generale</h2>
      <p style="color:var(--text-light);font-family:var(--font);font-weight:600;font-size:15px;margin-bottom:20px">
        Una sessione di domande miste su tutti gli argomenti studiati.<br>Quante domande vuoi fare?
      </p>
      <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-bottom:24px">
        <button onclick="startRipasso(20)" style="padding:14px 24px;background:var(--primary);color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:17px;cursor:pointer">20 domande</button>
        <button onclick="startRipasso(25)" style="padding:14px 24px;background:var(--accent);color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:17px;cursor:pointer">25 domande</button>
        <button onclick="startRipasso(30)" style="padding:14px 24px;background:#f43f5e;color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:17px;cursor:pointer">30 domande</button>
      </div>
      <div id="ripassoBestBox" style="display:none;background:var(--primary-light);border-radius:12px;padding:12px 16px;font-family:var(--font)">
        <span style="font-weight:700;font-size:14px;color:var(--primary)">ðŸ† Il tuo record: <span id="ripassoBest">â€”</span></span>
      </div>
    </div>

    <!-- schermata QUIZ in corso -->
    <div id="ripassoQuiz" style="display:none">
      <div class="card" style="padding:16px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-family:var(--font);font-weight:800">
          <span id="rpProgress" style="color:var(--text-light);font-size:14px">1 / 20</span>
          <span id="rpScore" style="color:var(--primary);font-size:15px">âœ… 0</span>
          <span id="rpTopic" style="font-size:12px;background:var(--border);border-radius:20px;padding:3px 10px;color:var(--text-light)">â€”</span>
        </div>
        <div id="rpBar" style="height:6px;background:var(--border);border-radius:3px;margin-bottom:16px">
          <div id="rpBarFill" style="height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;width:0%;transition:width 0.4s"></div>
        </div>
        <p id="rpQuestion" style="font-family:var(--font);font-weight:700;font-size:16px;line-height:1.5;margin-bottom:16px;min-height:60px"></p>
        <div id="rpOpts" style="display:flex;flex-direction:column;gap:10px"></div>
        <div id="rpHint" style="display:none;margin-top:14px;padding:12px;background:var(--accent-light);border-radius:12px;font-family:var(--font);font-weight:700;font-size:14px;color:var(--accent)"></div>
        <button id="rpNext" onclick="rpNextQuestion()" style="display:none;margin-top:16px;width:100%;padding:14px;background:var(--primary);color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:16px;cursor:pointer">Prossima â†’</button>
      </div>
    </div>

    <!-- schermata RISULTATO -->
    <div id="ripassoResult" style="display:none" class="card">
      <div style="text-align:center;padding:16px 0 20px">
        <div id="rpResultEmoji" style="font-size:60px;margin-bottom:10px">ðŸŽ‰</div>
        <h2 id="rpResultTitle" style="font-family:var(--font);font-weight:900;font-size:22px;margin-bottom:6px"></h2>
        <p id="rpResultSub" style="font-family:var(--font);font-weight:600;color:var(--text-light);font-size:15px;margin-bottom:20px"></p>
        <div id="rpResultByTopic" style="text-align:left;margin-bottom:20px"></div>
        <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
          <button onclick="startRipasso(rpState.total)" style="padding:13px 22px;background:var(--primary);color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:15px;cursor:pointer">ðŸ”„ Rifai (stesse domande)</button>
          <button onclick="showRipasso()" style="padding:13px 22px;background:var(--accent);color:white;border:none;border-radius:14px;font-family:var(--font);font-weight:800;font-size:15px;cursor:pointer">ðŸ†• Nuova sessione</button>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- BOTTOM NAV -->
<nav class="bottom-nav">
  <button class="nav-item active" id="nav-home" onclick="showPage('home')" aria-label="Home">
    <span class="ni">ðŸ </span><span class="nl">Home</span>
  </button>
  <button class="nav-item" id="nav-ripasso" onclick="showRipasso()" aria-label="Ripasso">
    <span class="ni">ðŸŽ¯</span><span class="nl">Ripasso</span>
  </button>
  <button class="nav-item" id="nav-stats" onclick="showPage('stats')" aria-label="Progressi">
    <span class="ni">ðŸ“Š</span><span class="nl">Progressi</span>
  </button>
  <button class="nav-item" id="nav-set" onclick="showPage('settings')" aria-label="Impostazioni">
    <span class="ni">âš™ï¸</span><span class="nl">Imposta</span>
  </button>
</nav>

<!-- INSTALL BANNER â€” Android PWA (beforeinstallprompt) -->
<div id="install-banner">
  <p>ðŸ“² Installa MathUp sul telefono!</p>
  <button class="install-btn" id="installBtn">Installa</button>
  <button class="install-x" onclick="document.getElementById('install-banner').classList.remove('show')">âœ•</button>
</div>

<!-- TAVOLE NUMERICHE MODAL -->
<div class="overlay" id="mTav" onclick="if(event.target===this)closeModal('mTav')">
  <div class="modal" style="max-width:520px">
    <div class="modal-handle"></div>
    <h3>ðŸ”¢ Tavole Numeriche (1â€“1000)</h3>
    <div style="font-family:var(--font);margin-bottom:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <label style="font-weight:700;font-size:14px">Da:</label>
      <input id="tavFrom" type="number" min="1" max="999" value="1"
        style="width:70px;padding:6px;border-radius:8px;border:2px solid var(--border);font-family:var(--font);font-weight:700;font-size:14px">
      <label style="font-weight:700;font-size:14px">A:</label>
      <input id="tavTo" type="number" min="2" max="1000" value="20"
        style="width:70px;padding:6px;border-radius:8px;border:2px solid var(--border);font-family:var(--font);font-weight:700;font-size:14px">
      <button onclick="renderTavole()" style="padding:7px 16px;background:var(--primary);color:white;border:none;border-radius:10px;font-family:var(--font);font-weight:800;font-size:14px;cursor:pointer">Mostra</button>
    </div>
    <div style="overflow-x:auto;max-height:55vh;overflow-y:auto;border-radius:12px;border:2px solid var(--border)">
      <table id="tavTable" style="border-collapse:collapse;width:100%;font-family:var(--font);font-size:13px">
        <thead>
          <tr style="background:var(--primary);color:white;position:sticky;top:0">
            <th style="padding:8px 10px;text-align:right">n</th>
            <th style="padding:8px 10px;text-align:right">nÂ²</th>
            <th style="padding:8px 10px;text-align:right">nÂ³</th>
            <th style="padding:8px 10px;text-align:right">âˆšn</th>
            <th style="padding:8px 10px;text-align:right">âˆ›n</th>
          </tr>
        </thead>
        <tbody id="tavBody"></tbody>
      </table>
    </div>
    <button class="modal-close" onclick="closeModal('mTav')">âœ“ Chiudi</button>
  </div>
</div>

<!-- NUMERI PRIMI MODAL -->
<div class="overlay" id="mPrim" onclick="if(event.target===this)closeModal('mPrim')">
  <div class="modal" style="max-width:520px">
    <div class="modal-handle"></div>
    <h3>ðŸ”µ Numeri Primi &lt; 10 000</h3>
    <div style="font-family:var(--font);font-size:13px;color:var(--text-light);margin-bottom:10px;font-weight:700">
      Un numero primo Ã¨ divisibile <strong>solo per 1 e per se stesso</strong>.
      Ci sono <strong>1229</strong> numeri primi minori di 10 000.
    </div>
    <div style="font-family:var(--font);margin-bottom:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <label style="font-weight:700;font-size:14px">Cerca nÂ°:</label>
      <input id="primSearch" type="number" min="2" max="9999" placeholder="es. 97"
        style="width:90px;padding:6px;border-radius:8px;border:2px solid var(--border);font-family:var(--font);font-weight:700;font-size:14px"
        oninput="checkPrimo(this.value)">
      <span id="primSearchResult" style="font-family:var(--font);font-weight:800;font-size:14px"></span>
    </div>
    <div style="overflow-y:auto;max-height:55vh;border-radius:12px;border:2px solid var(--border);padding:10px;background:white;line-height:2" id="primList"></div>
    <button class="modal-close" onclick="closeModal('mPrim')">âœ“ Chiudi</button>
  </div>
</div>

<!-- iOS INSTALL GUIDE MODAL -->
<div class="overlay" id="mIos" onclick="if(event.target===this)closeModal('mIos')">
  <div class="modal">
    <div class="modal-handle"></div>
    <h3>ðŸ“² Installa su iPhone / iPad</h3>
    <div style="text-align:center;margin-bottom:18px">
      <div style="background:var(--primary);color:white;border-radius:16px;padding:16px;font-family:var(--font);font-weight:900;font-size:18px">
        Apri questa pagina in <strong>Safari</strong> se non ci sei giÃ 
      </div>
    </div>
    <div style="font-family:var(--font);font-size:16px;line-height:1;font-weight:700">
      <div style="display:flex;align-items:center;gap:14px;padding:14px 0;border-bottom:1px solid var(--border)">
        <div style="width:40px;height:40px;border-radius:50%;background:var(--primary);color:white;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">1</div>
        <div>Tocca il pulsante <strong>Condividi</strong> <span style="font-size:22px">â¬†ï¸</span> nella barra in basso di Safari</div>
      </div>
      <div style="display:flex;align-items:center;gap:14px;padding:14px 0;border-bottom:1px solid var(--border)">
        <div style="width:40px;height:40px;border-radius:50%;background:var(--primary);color:white;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">2</div>
        <div>Scorri verso il basso e tocca <strong>"Aggiungi alla schermata Home"</strong> ðŸ </div>
      </div>
      <div style="display:flex;align-items:center;gap:14px;padding:14px 0">
        <div style="width:40px;height:40px;border-radius:50%;background:var(--primary);color:white;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">3</div>
        <div>Tocca <strong>"Aggiungi"</strong> in alto a destra â€” fatto! ðŸŽ‰</div>
      </div>
    </div>
    <div style="background:var(--primary-light);border-radius:14px;padding:14px;margin-top:10px;border-left:4px solid var(--primary);font-family:var(--font);font-weight:700;font-size:14px;color:#7c2d12">
      âœ… ApparirÃ  l'icona arancione <strong>MathUp</strong> sulla tua schermata Home â€” e funziona anche senza internet!
    </div>
    <button class="modal-close" onclick="closeModal('mIos')">âœ“ Ho capito, grazie!</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="overlay" id="mCalc" onclick="if(event.target===this)closeModal('mCalc')">
  <div class="modal">
    <div class="modal-handle"></div>
    <h3>ðŸ”¢ Calcolatrice</h3>
    <div class="calc">
      <div class="calc-disp" id="calcDisp">0</div>
      <div class="calc-grid">
        <button class="cb clr" onclick="ci('C')">C</button>
        <button class="cb op" onclick="ci('Â±')">Â±</button>
        <button class="cb op" onclick="ci('âˆš')" style="font-size:18px">âˆš</button>
        <button class="cb op" onclick="ci('Ã·')">Ã·</button>
        <button class="cb" onclick="ci('7')">7</button><button class="cb" onclick="ci('8')">8</button>
        <button class="cb" onclick="ci('9')">9</button><button class="cb op" onclick="ci('Ã—')">Ã—</button>
        <button class="cb" onclick="ci('4')">4</button><button class="cb" onclick="ci('5')">5</button>
        <button class="cb" onclick="ci('6')">6</button><button class="cb op" onclick="ci('âˆ’')">âˆ’</button>
        <button class="cb" onclick="ci('1')">1</button><button class="cb" onclick="ci('2')">2</button>
        <button class="cb" onclick="ci('3')">3</button><button class="cb op" onclick="ci('+')">+</button>
        <button class="cb z" onclick="ci('0')">0</button>
        <button class="cb" onclick="ci('.')">.</button>
        <button class="cb eq" onclick="ci('=')">= </button>
      </div>
    </div>
    <button class="modal-close" onclick="closeModal('mCalc')">âœ“ Chiudi</button>
  </div>
</div>

<div class="overlay" id="mPita" onclick="if(event.target===this)closeModal('mPita')">
  <div class="modal">
    <div class="modal-handle"></div>
    <h3>âœ–ï¸ Tavola Pitagorica</h3>
    <div style="overflow-x:auto"><table class="pt" id="pitaTable"></table></div>
    <button class="modal-close" onclick="closeModal('mPita')">âœ“ Chiudi</button>
  </div>
</div>

<div class="overlay" id="mForm" onclick="if(event.target===this)closeModal('mForm')">
  <div class="modal">
    <div class="modal-handle"></div>
    <h3>ðŸ“ Formule & Inverse</h3>
    <div id="formuleList"></div>
    <button class="modal-close" onclick="closeModal('mForm')">âœ“ Chiudi</button>
  </div>
</div>

<div class="overlay" id="mReg" onclick="if(event.target===this)closeModal('mReg')">
  <div class="modal">
    <div class="modal-handle"></div>
    <h3>Â± Regole dei Segni</h3>
    <div style="font-family:var(--font);font-weight:700;font-size:17px;line-height:2.6">
      <p>âž• Ã— âž• = <strong style="color:var(--green)">POSITIVO</strong></p>
      <p>âž– Ã— âž– = <strong style="color:var(--green)">POSITIVO</strong></p>
      <p>âž• Ã— âž– = <strong style="color:var(--red)">NEGATIVO</strong></p>
      <p>âž– Ã— âž• = <strong style="color:var(--red)">NEGATIVO</strong></p>
      <hr style="margin:8px 0;opacity:0.15">
      <p style="font-size:14px;color:var(--text-light)">Segni <strong>uguali</strong> â†’ risultato <strong style="color:var(--green)">+</strong></p>
      <p style="font-size:14px;color:var(--text-light)">Segni <strong>diversi</strong> â†’ risultato <strong style="color:var(--red)">âˆ’</strong></p>
    </div>
    <button class="modal-close" onclick="closeModal('mReg')">âœ“ Chiudi</button>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA & STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const state = {
  points: 0,
  sound: false,
  topic: null,
  quizIdx: 0,
  quizAnswered: false,
  progress: { numeri:{done:0,correct:0}, frazioni:{done:0,correct:0}, geometria:{done:0,correct:0}, pitagora:{done:0,correct:0}, algebra:{done:0,correct:0}, statistica:{done:0,correct:0}, radicali:{done:0,correct:0} }
};
let installPrompt = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUIZ DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const QUIZZES = {

numeri: [
  { q:'Quale numero Ã¨ piÃ¹ grande?', opts:['âˆ’3','0','+2','âˆ’10'], ans:'+2', hint:'Sulla retta, piÃ¹ stai a destra = piÃ¹ grande.' },
  { q:'Ordina dal piÃ¹ piccolo: +2, âˆ’5, 0, âˆ’1', opts:['âˆ’5 < âˆ’1 < 0 < +2','0 < âˆ’1 < âˆ’5 < +2','âˆ’1 < âˆ’5 < 0 < +2','+2 < 0 < âˆ’1 < âˆ’5'], ans:'âˆ’5 < âˆ’1 < 0 < +2', hint:'I negativi piÃ¹ lontani da zero sono i piÃ¹ piccoli.' },
  { q:'Quanto fa (+5) + (âˆ’3)?', opts:['8','2','âˆ’2','+15'], ans:'2', hint:'Parti da +5, fai 3 passi a sinistra sulla retta.' },
  { q:'Quanto fa (âˆ’4) + (âˆ’2)?', opts:['âˆ’6','6','âˆ’2','2'], ans:'âˆ’6', hint:'Due negativi si sommano: 4+2=6, poi metti il segno âˆ’.' },
  { q:'Quanto fa (âˆ’4) Ã— (âˆ’2)?', opts:['âˆ’8','8','âˆ’6','6'], ans:'8', hint:'Segni uguali â†’ risultato positivo. 4Ã—2=8.' },
  { q:'Quanto fa (+6) Ã— (âˆ’3)?', opts:['âˆ’18','18','âˆ’9','9'], ans:'âˆ’18', hint:'Segni diversi â†’ risultato negativo. 6Ã—3=18.' },
  { q:'Quanto fa (âˆ’12) Ã· (+4)?', opts:['âˆ’3','3','âˆ’8','8'], ans:'âˆ’3', hint:'Segni diversi â†’ negativo. 12Ã·4=3.' },
  { q:'Quale affermazione Ã¨ VERA?', opts:['âˆ’7 > âˆ’3','âˆ’1 < 0','0 < âˆ’5','+2 < âˆ’4'], ans:'âˆ’1 < 0', hint:'Zero Ã¨ piÃ¹ grande di qualsiasi numero negativo.' },
  { q:'Quanto fa (+3) âˆ’ (âˆ’5)?', opts:['âˆ’2','2','8','âˆ’8'], ans:'8', hint:'Sottrarre un negativo = sommare il positivo: 3+5=8.' },
  { q:'La temperatura era âˆ’3Â°C e Ã¨ scesa di 4Â°C. Ora Ã¨:', opts:['âˆ’7Â°C','+1Â°C','âˆ’1Â°C','+7Â°C'], ans:'âˆ’7Â°C', hint:'âˆ’3 + (âˆ’4) = âˆ’7. Scendere = sommare un negativo.' },
],

frazioni: [
  { q:'Qual Ã¨ la forma ridotta di 4/8?', opts:['1/2','2/4','3/6','4/8'], ans:'1/2', hint:'Dividi sia numeratore che denominatore per 4.' },
  { q:'Quale frazione Ã¨ la piÃ¹ grande?', opts:['1/4','1/3','1/5','1/6'], ans:'1/3', hint:'Stesso numeratore: il denominatore piÃ¹ piccolo dÃ  la frazione piÃ¹ grande.' },
  { q:'Quanto fa 1/2 + 1/4?', opts:['2/6','3/4','2/8','1/3'], ans:'3/4', hint:'Riduci allo stesso denominatore: 2/4 + 1/4 = 3/4.' },
  { q:'Quanto fa 3/5 Ã— 2/3?', opts:['6/15','5/8','2/5','3/8'], ans:'2/5', hint:'Moltiplica: (3Ã—2)/(5Ã—3) = 6/15 = 2/5.' },
  { q:'Quanto fa 3/4 âˆ’ 1/2?', opts:['2/2','1/4','1/2','2/4'], ans:'1/4', hint:'1/2 = 2/4. Poi 3/4 âˆ’ 2/4 = 1/4.' },
  { q:'Qual Ã¨ il reciproco di 3/5?', opts:['3/5','5/3','1/5','6/10'], ans:'5/3', hint:'Capovolgi la frazione: numeratore e denominatore si scambiano.' },
  { q:'Quanto fa 2/3 Ã· 4/9?', opts:['8/27','3/2','1/2','9/6'], ans:'3/2', hint:'Dividi = moltiplica per il reciproco: 2/3 Ã— 9/4 = 18/12 = 3/2.' },
  { q:'Quale frazione Ã¨ equivalente a 6/9?', opts:['3/4','2/3','1/3','4/6'], ans:'2/3', hint:'Semplifica dividendo per 3: 6Ã·3=2, 9Ã·3=3.' },
  { q:'Un quarto di 20 Ã¨:', opts:['10','4','5','8'], ans:'5', hint:'1/4 Ã— 20 = 20Ã·4 = 5.' },
  { q:'Tre ottavi (3/8) scritti come percentuale Ã¨ circa:', opts:['37,5%','38%','30%','25%'], ans:'37,5%', hint:'3Ã·8 = 0,375 â†’ moltiplica per 100.' },
],

geometria: [
  // FORMULE DIRETTE
  { q:'Rettangolo: base=6 cm, altezza=4 cm. Qual Ã¨ l\'area?', opts:['24 cmÂ²','20 cmÂ²','10 cmÂ²','16 cmÂ²'], ans:'24 cmÂ²', hint:'A = base Ã— altezza = 6 Ã— 4', vis:'â–­ b=6, h=4' },
  { q:'Triangolo: base=8 cm, altezza=5 cm. Qual Ã¨ l\'area?', opts:['40 cmÂ²','13 cmÂ²','20 cmÂ²','80 cmÂ²'], ans:'20 cmÂ²', hint:'A = (base Ã— altezza) Ã· 2 = (8Ã—5)Ã·2', vis:'â–³ b=8, h=5' },
  { q:'Trapezio: B=10, b=6, h=4. Qual Ã¨ l\'area?', opts:['40 cmÂ²','32 cmÂ²','60 cmÂ²','24 cmÂ²'], ans:'32 cmÂ²', hint:'A = (B+b)/2 Ã— h = (10+6)/2 Ã— 4 = 8Ã—4', vis:'âŒ‚ B=10, b=6, h=4' },
  { q:'Parallelogramma: base=7 cm, altezza=3 cm. Area?', opts:['21 cmÂ²','10 cmÂ²','42 cmÂ²','14 cmÂ²'], ans:'21 cmÂ²', hint:'A = base Ã— altezza = 7 Ã— 3', vis:'â¬§ b=7, h=3' },
  { q:'Quadrato con lato=5 cm. Qual Ã¨ l\'area?', opts:['20 cmÂ²','10 cmÂ²','25 cmÂ²','15 cmÂ²'], ans:'25 cmÂ²', hint:'A = latoÂ² = 5Â² = 25', vis:'â–  l=5' },
  // FORMULE INVERSE â€” trovare un lato
  { q:'ðŸ“ FORMULA INVERSA: Un rettangolo ha area=30 cmÂ² e altezza=5 cm. Quanto Ã¨ la base?', opts:['6 cm','25 cm','150 cm','3 cm'], ans:'6 cm', hint:'Base = Area Ã· altezza = 30 Ã· 5', vis:'Area=30, h=5 â†’ b=?' },
  { q:'ðŸ“ FORMULA INVERSA: Un triangolo ha area=18 cmÂ² e altezza=6 cm. Quanto Ã¨ la base?', opts:['3 cm','6 cm','108 cm','12 cm'], ans:'6 cm', hint:'b = (2 Ã— Area) Ã· h = (2Ã—18)Ã·6 = 36Ã·6', vis:'Area=18, h=6 â†’ b=?' },
  { q:'ðŸ“ FORMULA INVERSA: Un parallelogramma ha area=42 cmÂ² e base=7 cm. Quanto Ã¨ l\'altezza?', opts:['6 cm','49 cm','294 cm','5 cm'], ans:'6 cm', hint:'h = Area Ã· base = 42 Ã· 7', vis:'Area=42, b=7 â†’ h=?' },
  { q:'ðŸ“ FORMULA INVERSA: Un quadrato ha area=64 cmÂ². Quanto Ã¨ il lato?', opts:['8 cm','16 cm','32 cm','4 cm'], ans:'8 cm', hint:'lato = âˆšArea = âˆš64 = 8. Usa la tavola delle radici!', vis:'Area=64 â†’ l=?' },
  { q:'ðŸ“ FORMULA INVERSA: Un trapezio ha area=20 cmÂ², h=4 cm, base minore b=3. Quanto Ã¨ la base maggiore B?', opts:['7 cm','5 cm','10 cm','17 cm'], ans:'7 cm', hint:'A=(B+b)/2Ã—h â†’ B = (2Ã—A/h) âˆ’ b = (2Ã—20/4)âˆ’3 = 10âˆ’3', vis:'Area=20, h=4, b=3 â†’ B=?' },
  // PERIMETRI
  { q:'Rettangolo: b=7 cm, h=3 cm. Qual Ã¨ il perimetro?', opts:['20 cm','21 cm','10 cm','40 cm'], ans:'20 cm', hint:'P = 2Ã—(b+h) = 2Ã—(7+3) = 2Ã—10 = 20', vis:'â–­ perimetro' },
  { q:'Quadrato con lato=6 cm. Perimetro?', opts:['24 cm','12 cm','36 cm','18 cm'], ans:'24 cm', hint:'P = 4 Ã— lato = 4Ã—6 = 24', vis:'â–  perimetro' },
  // FORMULA INVERSA PERIMETRO
  { q:'ðŸ“ INVERSA: Un rettangolo ha perimetro=24 cm e base=8 cm. Quanto Ã¨ l\'altezza?', opts:['4 cm','16 cm','3 cm','12 cm'], ans:'4 cm', hint:'P=2(b+h) â†’ h = P/2 âˆ’ b = 12âˆ’8 = 4', vis:'P=24, b=8 â†’ h=?' },
  { q:'ðŸ“ INVERSA: Un quadrato ha perimetro=36 cm. Quanto Ã¨ il lato?', opts:['9 cm','12 cm','4 cm','18 cm'], ans:'9 cm', hint:'P = 4Ã—l â†’ l = PÃ·4 = 36Ã·4', vis:'P=36 â†’ l=?' },
  { q:'Se raddoppio la base di un rettangolo (altezza invariata), l\'area:', opts:['rimane uguale','si raddoppia','si dimezza','si quadruplica'], ans:'si raddoppia', hint:'A=bÃ—h. Se bâ†’2b, allora Aâ†’2bÃ—h = 2Ã—(bÃ—h).', vis:'' },
],

pitagora: [
  { q:'Cateti 3 e 4. Ipotenusa?', opts:['5','7','6','4,5'], ans:'5', hint:'3Â²+4Â²=9+16=25. âˆš25=5! Ãˆ la terna pitagorica piÃ¹ famosa.' },
  { q:'Cateti 6 e 8. Ipotenusa?', opts:['14','10','9','12'], ans:'10', hint:'36+64=100. âˆš100=10.' },
  { q:'Cateti 5 e 12. Ipotenusa?', opts:['17','13','15','11'], ans:'13', hint:'25+144=169. âˆš169=13.' },
  { q:'Cateti 8 e 15. Ipotenusa?', opts:['17','21','23','19'], ans:'17', hint:'64+225=289. âˆš289=17.' },
  // INVERSE â€” trovare un cateto
  { q:'ðŸ“ INVERSA: Ipotenusa=10, un cateto=6. Quanto Ã¨ l\'altro cateto?', opts:['4','8','6','âˆš136'], ans:'8', hint:'b=âˆš(cÂ²âˆ’aÂ²)=âˆš(100âˆ’36)=âˆš64=8.' },
  { q:'ðŸ“ INVERSA: Ipotenusa=13, un cateto=5. Quanto Ã¨ l\'altro cateto?', opts:['8','10','12','9'], ans:'12', hint:'b=âˆš(169âˆ’25)=âˆš144=12.' },
  { q:'ðŸ“ INVERSA: Ipotenusa=17, un cateto=8. Quanto Ã¨ l\'altro cateto?', opts:['9','15','12','10'], ans:'15', hint:'b=âˆš(289âˆ’64)=âˆš225=15.' },
  { q:'L\'ipotenusa Ã¨...', opts:['il lato piÃ¹ corto','qualsiasi lato','il lato opposto all\'angolo retto','adiacente all\'angolo retto'], ans:'il lato opposto all\'angolo retto', hint:'L\'ipotenusa Ã¨ sempre di fronte al 90Â°.' },
  { q:'Un triangolo con lati 3, 4, 6 Ã¨ rettangolo?', opts:['SÃ¬','No â€” non vale aÂ²+bÂ²=cÂ²','Non si puÃ² dire','Solo se l\'angolo Ã¨ 45Â°'], ans:'No â€” non vale aÂ²+bÂ²=cÂ²', hint:'3Â²+4Â²=25. 6Â²=36. 25â‰ 36, quindi NON Ã¨ rettangolo.' },
  { q:'Un quadrato con diagonale=10 cm: quanto Ã¨ il lato? (lÂ²+lÂ²=100)', opts:['5 cm','âˆš50 â‰ˆ 7,07 cm','âˆš200 cm','10 cm'], ans:'âˆš50 â‰ˆ 7,07 cm', hint:'2lÂ²=100 â†’ lÂ²=50 â†’ l=âˆš50â‰ˆ7,07.' },
],

algebra: [
  { q:'Se x + 4 = 9, quanto vale x?', opts:['5','13','4','6'], ans:'5', hint:'Togli 4 da entrambe le parti: x = 9 âˆ’ 4.' },
  { q:'Quanto vale 3x se x = 4?', opts:['7','34','12','1'], ans:'12', hint:'3x = 3 Ã— 4 = 12.' },
  { q:'Se 2x = 10, quanto vale x?', opts:['5','20','8','12'], ans:'5', hint:'Dividi entrambe le parti per 2: x = 10Ã·2.' },
  { q:'Se x âˆ’ 3 = 7, quanto vale x?', opts:['4','10','21','âˆ’4'], ans:'10', hint:'Aggiungi 3 a entrambe le parti: x = 7+3.' },
  { q:'Quale espressione Ã¨ un MONOMIO?', opts:['x+2','3xÂ²','x+y','2xâˆ’1'], ans:'3xÂ²', hint:'Un monomio Ã¨ un singolo termine senza somme o differenze.' },
  { q:'Quanto vale 2x + 3 se x = 5?', opts:['10','13','16','8'], ans:'13', hint:'Sostituisci: 2Ã—5+3 = 10+3 = 13.' },
  { q:'Se 3x + 1 = 10, quanto vale x?', opts:['3','9','11','4'], ans:'3', hint:'Prima togli 1: 3x=9. Poi dividi per 3: x=3.' },
  { q:'Somma dei monomi 2x e 5x:', opts:['10xÂ²','7x','7xÂ²','3x'], ans:'7x', hint:'Somma i coefficienti (2+5=7) e tieni la stessa lettera.' },
  { q:'Quanto vale âˆ’2x se x = âˆ’3?', opts:['âˆ’6','6','+2','âˆ’1'], ans:'6', hint:'âˆ’2 Ã— (âˆ’3) = +6. Segni uguali â†’ positivo.' },
  { q:'Se x/4 = 3, quanto vale x?', opts:['0,75','7','12','1'], ans:'12', hint:'Moltiplica entrambe le parti per 4: x = 3Ã—4 = 12.' },
],

statistica: [
  { q:'Media di: 4, 6, 8, 2', opts:['5','6','4','7'], ans:'5', hint:'Somma=20. Media=20Ã·4=5.' },
  { q:'Media di: 10, 6, 8, 4, 2', opts:['5','6','4','7'], ans:'6', hint:'Somma=30. Media=30Ã·5=6.' },
  { q:'Moda di: 3, 5, 3, 7, 5, 3', opts:['5','7','3','6'], ans:'3', hint:'3 compare 3 volte â€” Ã¨ il dato piÃ¹ frequente.' },
  { q:'Mediana di: 2, 4, 6, 8, 10', opts:['4','6','5','8'], ans:'6', hint:'5 elementi: il terzo Ã¨ il centrale â†’ 6.' },
  { q:'Mediana di: 3, 5, 7, 9 (4 elementi)', opts:['6','5','7','4'], ans:'6', hint:'Con 4 elementi: media dei due centrali = (5+7)/2 = 6.' },
  { q:'Moda di: 1, 2, 2, 3, 3, 3, 4', opts:['1','2','3','4'], ans:'3', hint:'3 compare 3 volte, piÃ¹ di tutti.' },
  { q:'Media di: 0, 0, 6, 0', opts:['6','2','1,5','3'], ans:'1,5', hint:'Somma=6. Media=6Ã·4=1,5. Anche gli zeri contano!' },
  { q:'Ordina per trovare la mediana di: 5, 1, 9, 3, 7', opts:['5','3','1','7'], ans:'5', hint:'Ordinati: 1,3,5,7,9. Il valore di mezzo (3Â°) Ã¨ 5.' },
  { q:'Se aggiungessi il dato 100 a {2,3,4,5,6}, la MEDIAâ€¦', opts:['non cambia','sale molto','scende','rimane circa uguale'], ans:'sale molto', hint:'100 Ã¨ molto piÃ¹ grande degli altri, alza la media di molto.' },
  { q:'La MEDIANA Ã¨ piÃ¹ "robusta" della media perchÃ©:', opts:['Ã¨ sempre piÃ¹ grande','non Ã¨ influenzata dai valori estremi','Ã¨ piÃ¹ facile da calcolare','Ã¨ uguale alla moda'], ans:'non Ã¨ influenzata dai valori estremi', hint:'Anche se c\'Ã¨ un dato abnorme, la mediana non cambia tanto.' },
],

radicali: [
  // â”€â”€ POTENZE â”€â”€
  { q:'Quanto vale 3Â² (3 alla seconda)?', opts:['6','9','8','27'], ans:'9', hint:'3Â² = 3Ã—3 = 9. Moltiplica la base per se stessa tante volte quant\'Ã¨ l\'esponente.' },
  { q:'Quanto vale 2âµ?', opts:['10','16','32','64'], ans:'32', hint:'2âµ = 2Ã—2Ã—2Ã—2Ã—2 = 4Ã—4Ã—2 = 32.' },
  { q:'Quanto vale 10Â³?', opts:['30','100','1000','10000'], ans:'1000', hint:'10Â³ = 10Ã—10Ã—10 = 1000. Le potenze di 10 aggiungono tanti zeri quanto l\'esponente!' },
  { q:'Quanto vale 4â°?', opts:['0','4','1','Impossibile'], ans:'1', hint:'Qualsiasi numero (â‰ 0) elevato a 0 vale SEMPRE 1. Regola fondamentale!' },
  { q:'Quanto vale 2â»Â³?', opts:['âˆ’8','âˆ’6','1/8','1/6'], ans:'1/8', hint:'Esponente negativo = inverso: 2â»Â³ = 1/2Â³ = 1/8.' },
  // â”€â”€ PROPRIETÃ€ POTENZE â”€â”€
  { q:'Prodotto di potenze stessa base: 2Â³ Ã— 2â´ = ?', opts:['2â·','4â·','2Â¹Â²','4Â¹Â²'], ans:'2â·', hint:'Stessa base? Si SOMMANO gli esponenti: 2Â³Ã—2â´ = 2^(3+4) = 2â·.' },
  { q:'Quoziente di potenze stessa base: 5â¶ Ã· 5Â² = ?', opts:['5â´','5Â³','5â¸','1â´'], ans:'5â´', hint:'Stessa base? Si SOTTRAGGONO gli esponenti: 5^(6âˆ’2) = 5â´.' },
  { q:'Potenza di potenza: (3Â²)â´ = ?', opts:['3â¶','3â¸','3Â²','9â´'], ans:'3â¸', hint:'Gli esponenti si MOLTIPLICANO: (3Â²)â´ = 3^(2Ã—4) = 3â¸.' },
  // â”€â”€ RADICALI â”€â”€
  { q:'Quanto vale âˆš81?', opts:['9','8','7','6'], ans:'9', hint:'âˆš81 = 9 perchÃ© 9Ã—9 = 81. Usa la tavola dei quadrati!' },
  { q:'Quanto vale âˆš144?', opts:['14','11','12','13'], ans:'12', hint:'12Ã—12 = 144 â†’ âˆš144 = 12.' },
  { q:'Quanto vale âˆ›27 (radice cubica)?', opts:['3','9','6','4'], ans:'3', hint:'âˆ›27 = 3 perchÃ© 3Ã—3Ã—3 = 27.' },
  { q:'Quanto vale âˆ›125?', opts:['5','25','15','10'], ans:'5', hint:'5Â³ = 5Ã—5Ã—5 = 125 â†’ âˆ›125 = 5.' },
  // â”€â”€ PROPRIETÃ€ RADICALI â”€â”€
  { q:'Semplifica: âˆš(4 Ã— 9) = ?', opts:['âˆš13','2âˆš9','âˆš36 = 6','âˆš4 + âˆš9'], ans:'âˆš36 = 6', hint:'âˆš(aÃ—b) = âˆša Ã— âˆšb â†’ âˆš36 = 6. Oppure calcola direttamente: âˆš36=6.' },
  { q:'Semplifica: âˆš50 = ?', opts:['5âˆš2','25âˆš2','5âˆš10','10âˆš5'], ans:'5âˆš2', hint:'50 = 25Ã—2 â†’ âˆš50 = âˆš25 Ã— âˆš2 = 5âˆš2. Porta fuori il quadrato perfetto!' },
  { q:'Qual Ã¨ la relazione corretta tra potenze e radici?', opts:['âˆša = a^(1/3)','âˆša = a^(1/2)','âˆša = aÂ²','âˆša = a^2'], ans:'âˆša = a^(1/2)', hint:'La radice quadrata Ã¨ uguale all\'esponente 1/2. Quindi âˆš9 = 9^(1/2) = 3.' },
],

};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LESSONS HTML
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LESSONS = {
numeri: `
<div class="card">
  <h2 style="color:#ef4444">Â± I Numeri Relativi</h2>
  <p>I numeri relativi hanno un <strong>segno</strong>: positivi (+) o negativi (âˆ’). Pensa alla <strong>temperatura</strong> o ai <strong>piani di un palazzo</strong>: il âˆ’2 Ã¨ il secondo piano interrato!</p>
  <div class="vb vb-orange">
    <h3>ðŸŒ¡ï¸ Tocca i numeri sulla retta:</h3>
    <div class="nl-scroll"><div class="nl-track" id="numLine"><div class="nl-axis"></div></div></div>
  </div>
  <div class="vb vb-teal">
    <h3>ðŸ“Œ Ordine sulla retta</h3>
    <p>PiÃ¹ andiamo a <strong>destra</strong> â†’ numero piÃ¹ grande<br>
    PiÃ¹ andiamo a <strong>sinistra</strong> â†’ numero piÃ¹ piccolo<br><br>
    âˆ’5 &lt; âˆ’3 &lt; âˆ’1 &lt; 0 &lt; +1 &lt; +3 &lt; +5</p>
  </div>
  <div class="vb vb-green">
    <h3>âž• Regola della somma</h3>
    <p>Stessi segni â†’ somma i valori, tieni il segno<br>
    Segni diversi â†’ sottrai il minore dal maggiore, prendi il segno del piÃ¹ grande</p>
  </div>
</div>`,

frazioni: `
<div class="card">
  <h2 style="color:#f59e0b">Â½ Le Frazioni</h2>
  <p>Una frazione Ã¨ una <strong>parte di un intero</strong>. Il numero sotto si chiama <strong>denominatore</strong> (quante parti), quello sopra <strong>numeratore</strong> (quante ne prendiamo).</p>
  <div class="vb vb-yellow">
    <h3>ðŸ• Muovi i cursori:</h3>
    <div class="slider-row"><label>Numeratore (parti colorate): <strong id="fNum">3</strong></label>
      <input type="range" min="1" max="8" value="3" id="fSlNum" oninput="updateFrac()"></div>
    <div class="slider-row"><label>Denominatore (parti totali): <strong id="fDen">4</strong></label>
      <input type="range" min="2" max="8" value="4" id="fSlDen" oninput="updateFrac()"></div>
    <div style="display:flex;align-items:center;gap:20px;flex-wrap:wrap;margin-top:8px">
      <div class="frac-parts" id="fracParts"></div>
      <div style="font-family:var(--font);font-weight:900;font-size:32px;color:var(--primary);text-align:center;min-width:80px">
        <div id="fDispN">3</div><div style="border-top:3px solid var(--primary);margin:4px 0"></div><div id="fDispD">4</div>
        <div style="font-size:14px;color:var(--text-light);margin-top:6px" id="fPct"></div>
      </div>
    </div>
  </div>
</div>`,

geometria: `
<div class="card">
  <h2 style="color:#3b82f6">ðŸ”· Geometria: Aree & Formule Inverse</h2>
  <p>L'area misura quanto <em>spazio occupa</em> una figura. Si misura in <strong>cmÂ², mÂ²</strong>â€¦</p>
  <div class="pills" id="geomPills">
    <div class="pill active" onclick="showGeomShape(this,'rect')">â–­ Rettangolo</div>
    <div class="pill" onclick="showGeomShape(this,'tri')">â–³ Triangolo</div>
    <div class="pill" onclick="showGeomShape(this,'para')">â¬§ Parallelogramma</div>
    <div class="pill" onclick="showGeomShape(this,'trap')">âŒ‚ Trapezio</div>
    <div class="pill" onclick="showGeomShape(this,'sq')">â–  Quadrato</div>
    <div class="pill" onclick="showGeomShape(this,'rombo')">â—‡ Rombo</div>
    <div class="pill" onclick="showGeomShape(this,'cerchio')">â­• Cerchio</div>
  </div>
  <div id="geomShape"></div>
  <div class="vb vb-purple" style="margin-top:16px">
    <h3>ðŸ” Come si usa la formula inversa?</h3>
    <p>Se conosco l'area ma non un lato, <strong>isolo</strong> il valore cercato:<br>
    A = bÃ—h &nbsp;â†’&nbsp; <strong>b = AÃ·h</strong> &nbsp;oppure&nbsp; <strong>h = AÃ·b</strong></p>
  </div>
</div>`,

pitagora: `
<div class="card">
  <h2 style="color:#8b5cf6">ðŸ“ Il Teorema di Pitagora</h2>
  <p>In un triangolo <strong>rettangolo</strong>: la somma dei quadrati dei due cateti = il quadrato dell'ipotenusa.</p>
  <div style="text-align:center;margin:16px 0">
    <span class="formula formula-purple">aÂ² + bÂ² = cÂ²</span>
    <p style="font-size:14px;color:var(--text-light);margin-top:8px">c = ipotenusa (lato piÃ¹ lungo, di fronte a 90Â°)</p>
  </div>
  <div class="vb vb-purple">
    <h3>ðŸŽ® Muovi i cursori â€” il triangolo si ridisegna!</h3>
    <div style="display:flex;gap:14px;flex-wrap:wrap">
      <div class="slider-row" style="flex:1;min-width:120px">
        <label>Cateto a: <strong id="pA">3</strong></label>
        <input type="range" min="1" max="9" value="3" id="slPA" oninput="drawPita()">
      </div>
      <div class="slider-row" style="flex:1;min-width:120px">
        <label>Cateto b: <strong id="pB">4</strong></label>
        <input type="range" min="1" max="9" value="4" id="slPB" oninput="drawPita()">
      </div>
    </div>
    <div style="display:flex;justify-content:center;margin-top:10px">
      <canvas id="pitaCanvas" width="320" height="260"></canvas>
    </div>
    <div class="geom-result" id="pitaResult"></div>
  </div>
  <div class="vb vb-blue">
    <h3>ðŸ” Formula inversa (trovare un cateto)</h3>
    <p>Se conosco c e un cateto a:<br>
    <strong>b = âˆš(cÂ² âˆ’ aÂ²)</strong></p>
  </div>
</div>`,

algebra: `
<div class="card">
  <h2 style="color:#22c55e">ðŸ”¤ Algebra: Lettere e Equazioni</h2>
  <p>In algebra le <strong>lettere sostituiscono numeri sconosciuti</strong>. Ãˆ come un gioco dove <strong>x</strong> Ã¨ la risposta da trovare!</p>
  <div class="vb vb-green">
    <h3>ðŸŽ La scatola misteriosa</h3>
    <p>ðŸ“¦ + 3 = 7 &nbsp;â†’&nbsp; quante palline nella scatola?<br>
    Con le lettere: &nbsp;<strong>x + 3 = 7 â†’ x = 4</strong></p>
  </div>
  <div class="vb vb-teal">
    <h3>âš–ï¸ Regola d'oro</h3>
    <p>Quello che fai a <strong>sinistra</strong> dell'uguale lo fai anche a <strong>destra</strong>.</p>
    <p style="margin-top:8px">Esempio: &nbsp;x + 5 = 12<br>
    â†’ tolgo 5 da entrambe le parti<br>
    â†’ x = 12 âˆ’ 5 = <strong>7</strong> âœ…</p>
  </div>
  <div class="vb vb-orange">
    <h3>ðŸ“š Tipi di espressioni</h3>
    <p>ðŸ”¹ <strong>Monomio</strong>: un solo termine â†’ 3xÂ², âˆ’5y, 2ab<br>
    ðŸ”¹ <strong>Polinomio</strong>: piÃ¹ monomi sommati â†’ 3x + 2y âˆ’ 1</p>
  </div>
</div>`,

statistica: `
<div class="card">
  <h2 style="color:#f59e0b">ðŸ“Š Statistica: Media, Moda, Mediana</h2>
  <p>La statistica ci aiuta a <strong>descrivere e capire i dati</strong>. I tre indicatori principali si chiamano <em>indici di posizione centrale</em>.</p>
  <div class="vb vb-yellow">
    <h3>ðŸ“Š Esempio: voti della settimana</h3>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin:10px 0" id="votiRow"></div>
    <div id="statCalc" style="font-family:var(--font);font-weight:700;font-size:15px;line-height:2.2;margin-top:10px"></div>
  </div>
  <div class="vb vb-teal">
    <h3>ðŸ“Œ Differenza chiave</h3>
    <p>ðŸ”¹ <strong>Media</strong>: Ã¨ influenzata dai valori estremi<br>
    ðŸ”¹ <strong>Mediana</strong>: Ã¨ "robusta" (non cambia con i valori anomali)<br>
    ðŸ”¹ <strong>Moda</strong>: il valore che "vince" per frequenza</p>
  </div>
</div>`,

radicali: `
<div class="card">
  <h2 style="color:#06b6d4">âˆš Potenze &amp; Radicali</h2>
  <p>Le <strong>potenze</strong> sono moltiplicazioni ripetute. Le <strong>radici</strong> sono l'operazione inversa. Insieme formano un sistema potentissimo per semplificare i calcoli!</p>

  <div class="vb" style="background:#ecfeff;border-left:4px solid #06b6d4">
    <h3>âš¡ Potenze â€” la base</h3>
    <div style="font-family:var(--font);font-size:15px;line-height:2.2">
      <p><strong>aâ¿</strong> = a Ã— a Ã— a â€¦ (n volte). La <em>base</em> Ã¨ a, l'<em>esponente</em> Ã¨ n.</p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin:10px 0">
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">2Â³ = 8<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">2Ã—2Ã—2</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">5Â² = 25<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">5Ã—5</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">10â´ = 10&nbsp;000<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">4 zeri!</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">7â° = 1<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">qualsiasi base!</span></div>
      </div>
      <p>âš ï¸ <strong>Esponente negativo:</strong> aâ»â¿ = 1/aâ¿ â†’ 2â»Â³ = 1/8</p>
    </div>
  </div>

  <div class="vb vb-orange" style="margin-top:14px">
    <h3>ðŸ“‹ ProprietÃ  delle Potenze</h3>
    <div style="font-family:var(--font);font-size:14px;line-height:2.4">
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Stessa base â€” prodotto</span><strong>aáµ Ã— aâ¿ = a^(m+n)</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Stessa base â€” quoziente</span><strong>aáµ Ã· aâ¿ = a^(mâˆ’n)</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Potenza di potenza</span><strong>(aáµ)â¿ = a^(mÃ—n)</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Prodotto, stessa potenza</span><strong>(aÃ—b)â¿ = aâ¿ Ã— bâ¿</strong></div>
      <div style="display:flex;justify-content:space-between;padding:4px 0"><span>ðŸ“Œ Esponente zero</span><strong>aâ° = 1 (con aâ‰ 0)</strong></div>
    </div>
    <div style="background:white;border-radius:12px;padding:12px;margin-top:10px;font-family:var(--font);font-weight:700;font-size:14px">
      <p>âœï¸ <strong>Esempi:</strong></p>
      <p>2Â³ Ã— 2â´ = 2â· = 128 &nbsp;(sommo gli esponenti)</p>
      <p>5â¶ Ã· 5Â² = 5â´ = 625 &nbsp;(sottraggo gli esponenti)</p>
      <p>(3Â²)Â³ = 3â¶ = 729 &nbsp;(moltiplico gli esponenti)</p>
    </div>
  </div>

  <div class="vb vb-blue" style="margin-top:14px">
    <h3>âˆš Radicali â€” l'operazione inversa</h3>
    <div style="font-family:var(--font);font-size:15px;line-height:2.2">
      <p><strong>âˆša</strong> (radice quadrata) = il numero che elevato al quadrato dÃ  <em>a</em></p>
      <p><strong>âˆ›a</strong> (radice cubica) = il numero che elevato al cubo dÃ  <em>a</em></p>
      <p style="color:var(--primary);font-weight:800">Regola chiave: &nbsp; âˆša = a^(Â½) &nbsp;&nbsp;&nbsp; âˆ›a = a^(â…“)</p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin:10px 0">
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">âˆš25 = 5<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">perchÃ© 5Â²=25</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">âˆš100 = 10<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">perchÃ© 10Â²=100</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">âˆ›8 = 2<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">perchÃ© 2Â³=8</span></div>
        <div style="background:white;border-radius:12px;padding:10px;text-align:center;font-weight:800">âˆ›64 = 4<br><span style="font-size:12px;font-weight:600;color:var(--text-light)">perchÃ© 4Â³=64</span></div>
      </div>
    </div>
  </div>

  <div class="vb vb-purple" style="margin-top:14px">
    <h3>ðŸ” ProprietÃ  dei Radicali</h3>
    <div style="font-family:var(--font);font-size:14px;line-height:2.4">
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Prodotto sotto radice</span><strong>âˆš(aÃ—b) = âˆša Ã— âˆšb</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Quoziente sotto radice</span><strong>âˆš(aÃ·b) = âˆša Ã· âˆšb</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Semplificazione</span><strong>âˆš(nÂ²Ã—a) = nâˆša</strong></div>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:4px 0"><span>ðŸ“Œ Quadrato della radice</span><strong>(âˆša)Â² = a</strong></div>
      <div style="display:flex;justify-content:space-between;padding:4px 0"><span>ðŸ“Œ Radice = potenza frazionaria</span><strong>âˆša = a^(1/2)</strong></div>
    </div>
    <div style="background:white;border-radius:12px;padding:12px;margin-top:10px;font-family:var(--font);font-weight:700;font-size:14px">
      <p>âœï¸ <strong>Esempio â€” Semplifica âˆš72:</strong></p>
      <p>1. Scomponi in fattori: 72 = 36 Ã— 2</p>
      <p>2. Porta fuori il quadrato perfetto: âˆš72 = âˆš(36Ã—2) = âˆš36 Ã— âˆš2</p>
      <p>3. Calcola âˆš36: &nbsp;<strong style="color:var(--primary)">= 6âˆš2</strong></p>
    </div>
  </div>

  <div class="vb vb-teal" style="margin-top:14px">
    <h3>ðŸ’¡ Quadrati perfetti da 1 a 225</h3>
    <div style="display:flex;flex-wrap:wrap;gap:6px;margin-top:8px;font-family:var(--font);font-weight:800;font-size:13px" id="sqPerfRow"></div>
  </div>
</div>`,
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(p) {
  document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
  const pages = { home:'pageHome', stats:'pageStats', settings:'pageSettings', ripasso:'pageRipasso' };
  const navs  = { home:'nav-home', stats:'nav-stats', settings:'nav-set', ripasso:'nav-ripasso' };
  if(pages[p]) document.getElementById(pages[p]).classList.add('active');
  if(navs[p]) document.getElementById(navs[p]).classList.add('active');
  if(p==='stats') renderStats();
  window.scrollTo(0,0);
}

function showTopic(name) {
  document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
  document.getElementById('pageTopicLesson').classList.add('active');

  const titles = {
    numeri:'Â± Numeri Relativi',
    frazioni:'Â½ Frazioni',
    geometria:'ðŸ”· Geometria & Aree',
    pitagora:'ðŸ“ Teorema di Pitagora',
    algebra:'ðŸ”¤ Algebra',
    statistica:'ðŸ“Š Statistica',
    radicali:'âˆš Potenze & Radicali',
  };
  document.getElementById('topicTitle').textContent = titles[name]||name;
  document.getElementById('lessonContent').innerHTML = LESSONS[name]||'';
  state.topic = name;
  state.quizIdx = 0;
  state.quizAnswered = false;

  // Init lesson interactives
  if(name==='numeri') setTimeout(initNumLine,100);
  if(name==='frazioni') setTimeout(()=>{updateFrac();},100);
  if(name==='geometria') setTimeout(()=>showGeomShape(document.querySelector('#geomPills .pill'),'rect'),100);
  if(name==='pitagora') setTimeout(drawPita,100);
  if(name==='statistica') setTimeout(initStat,100);
  if(name==='radicali') setTimeout(initRadicali,100);

  renderQuiz(name);
  window.scrollTo(0,0);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUIZ ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderQuiz(topic) {
  const data = QUIZZES[topic];
  const idx = state.quizIdx;
  const q = data[idx];
  const total = data.length;

  // Progress dots
  const prog = document.getElementById('qProgress');
  prog.innerHTML = data.map((_,i)=>{
    let cls = 'q-dot';
    const p = state.progress[topic];
    if(i<idx) cls+=' done-ok'; // simplification
    if(i===idx) cls+=' current';
    return `<div class="${cls}">${i+1}</div>`;
  }).join('');

  document.getElementById('qProgBar').style.width = (idx/total*100)+'%';

  const area = document.getElementById('quizArea');
  const qTitle = document.getElementById('exTitle');
  qTitle.textContent = `ðŸ’ª Esercizio ${idx+1} di ${total}`;

  const visHtml = q.vis ? `<div class="q-visual">ðŸ“Š ${q.vis}</div>` : '';

  area.innerHTML = `
    <div class="q-card">
      <div class="q-num">DOMANDA ${idx+1} / ${total}</div>
      ${visHtml}
      <div class="q-text">${q.q}</div>
      <div class="opts four-opts" id="optsGrid">
        ${q.opts.map(o=>`<button class="opt-btn" onclick="checkAns(this,'${o.replace(/'/g,"\\'")}','${q.ans.replace(/'/g,"\\'")}','${topic}')">${o}</button>`).join('')}
      </div>
      <button class="hint-btn" onclick="toggleHint()">ðŸ’¡ Suggerimento</button>
      <div class="hint-box" id="hintBox">${q.hint}</div>
      <div class="feedback" id="fbBox"></div>
    </div>`;
}

function checkAns(btn, chosen, correct, topic) {
  if(state.quizAnswered) return;
  state.quizAnswered = true;
  const fb = document.getElementById('fbBox');
  const grid = document.getElementById('optsGrid');

  // lock all
  grid.querySelectorAll('.opt-btn').forEach(b=>b.classList.add('locked'));

  if(chosen===correct) {
    btn.classList.add('correct');
    fb.innerHTML = 'ðŸŽ‰ Bravo! Risposta corretta!';
    fb.className = 'feedback show ok';
    playCorrect();
    addPoints(10);
    state.progress[topic].correct++;
  } else {
    btn.classList.add('wrong');
    grid.querySelectorAll('.opt-btn').forEach(b=>{ if(b.textContent===correct) b.classList.add('correct'); });
    fb.innerHTML = `âŒ Non Ã¨ quella. La risposta giusta era: <strong>${correct}</strong>`;
    fb.className = 'feedback show ko';
    playWrong();
  }
  state.progress[topic].done++;

  // Next
  const data = QUIZZES[topic];
  const nextBtn = document.createElement('button');
  nextBtn.className = 'next-btn';
  nextBtn.innerHTML = state.quizIdx >= data.length-1 ? 'ðŸ† Ricomincia da capo' : 'Prossima domanda â†’';
  nextBtn.onclick = () => {
    state.quizIdx = (state.quizIdx+1) % data.length;
    state.quizAnswered = false;
    renderQuiz(topic);
    saveProgress();
    updateHome();
  };
  document.querySelector('.q-card').appendChild(nextBtn);
}

function toggleHint() {
  document.getElementById('hintBox').classList.toggle('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LESSON INTERACTIVES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Number line
function initNumLine() {
  const nl = document.getElementById('numLine');
  if(!nl) return;
  nl.innerHTML = '<div class="nl-axis"></div>';
  for(let i=-5;i<=5;i++){
    const it = document.createElement('div');
    it.className = 'nl-item ' + (i<0?'neg':i===0?'zero':'pos');
    const lbl = i>0?'+'+i:String(i);
    it.innerHTML = `<div class="nl-dot">${lbl}</div><div class="nl-lbl">${i<0?'neg':i===0?'zero':'pos'}</div>`;
    it.onclick=()=>{ speak(lbl); it.querySelector('.nl-dot').style.transform='scale(1.4)'; setTimeout(()=>it.querySelector('.nl-dot').style.transform='',400); };
    nl.appendChild(it);
  }
}

// Fraction
function updateFrac() {
  const ns = document.getElementById('fSlNum');
  const ds = document.getElementById('fSlDen');
  if(!ns||!ds) return;
  const den = parseInt(ds.value);
  ns.max = den;
  const num = Math.min(parseInt(ns.value), den);
  ns.value = num;
  document.getElementById('fNum').textContent = num;
  document.getElementById('fDen').textContent = den;
  document.getElementById('fDispN').textContent = num;
  document.getElementById('fDispD').textContent = den;
  document.getElementById('fPct').textContent = Math.round(num/den*100)+'%';
  const parts = document.getElementById('fracParts');
  parts.innerHTML = '';
  for(let i=0;i<den;i++){
    const p=document.createElement('div');
    p.className='fp'+(i<num?' on':'');
    parts.appendChild(p);
  }
}

// Geometry shape display
const GEOM_SHAPES = {
  // â”€â”€â”€ Helper: compute adaptive scale so figure always fits in canvas â”€â”€â”€
  // PAD_TOP=30, PAD_BOT=28 (label), PAD_LEFT=44, PAD_RIGHT=14
  // maxW = 280-44-14=222, maxH = 240-30-28=182  (canvas is 280Ã—240)

  rect:{ name:'Rettangolo',
    formula:'A = b Ã— h &nbsp;&nbsp; P = 2(b+h)',
    inv:'b = A Ã· h  |  h = A Ã· b  |  b = P/2 âˆ’ h',
    color:'#3b82f6', vars:['base (b)','altezza (h)'],
    calc:(a,b)=>({a:a*b, p:2*(a+b)}),
    draw:(ctx,a,b)=>{
      const sc=Math.min(222/a, 182/b);
      const ox=44, oy=30;
      ctx.fillStyle='rgba(59,130,246,0.13)'; ctx.fillRect(ox,oy,a*sc,b*sc);
      ctx.strokeStyle='#3b82f6'; ctx.lineWidth=3; ctx.strokeRect(ox,oy,a*sc,b*sc);
      ctx.fillStyle='#3b82f6'; ctx.font='bold 14px Nunito,sans-serif';
      ctx.textAlign='center'; ctx.fillText('b='+a, ox+a*sc/2, oy+b*sc+20);
      ctx.textAlign='right';   ctx.fillText('h='+b, ox-6, oy+b*sc/2+5);
    }},

  tri:{ name:'Triangolo',
    formula:'A = (b Ã— h) Ã· 2 &nbsp;&nbsp; P = somma lati',
    inv:'b = (2Ã—A) Ã· h  |  h = (2Ã—A) Ã· b',
    color:'#ef4444', vars:['base (b)','altezza (h)'],
    calc:(a,b)=>({a:a*b/2, p:null}),
    draw:(ctx,a,b)=>{
      const sc=Math.min(222/a, 182/b);
      const ox=44, oy=30;
      ctx.beginPath(); ctx.moveTo(ox+a*sc/2,oy); ctx.lineTo(ox,oy+b*sc); ctx.lineTo(ox+a*sc,oy+b*sc); ctx.closePath();
      ctx.fillStyle='rgba(239,68,68,0.12)'; ctx.fill();
      ctx.strokeStyle='#ef4444'; ctx.lineWidth=3; ctx.stroke();
      ctx.setLineDash([5,4]); ctx.strokeStyle='#bbb'; ctx.lineWidth=1.5;
      ctx.beginPath(); ctx.moveTo(ox+a*sc/2,oy); ctx.lineTo(ox+a*sc/2,oy+b*sc); ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle='#ef4444'; ctx.font='bold 14px Nunito,sans-serif';
      ctx.textAlign='center'; ctx.fillText('b='+a, ox+a*sc/2, oy+b*sc+20);
      ctx.textAlign='right';   ctx.fillText('h='+b, ox+a*sc/2-4, oy+b*sc/2+5);
    }},

  para:{ name:'Parallelogramma',
    formula:'A = b Ã— h &nbsp;&nbsp; P = 2(b+l)',
    inv:'b = A Ã· h  |  h = A Ã· b',
    color:'#8b5cf6', vars:['base (b)','altezza (h)'],
    calc:(a,b)=>({a:a*b, p:null}),
    draw:(ctx,a,b)=>{
      const sc=Math.min(200/(a+1), 182/b);
      const off=Math.min(20, sc);
      const ox=44, oy=30;
      ctx.beginPath(); ctx.moveTo(ox+off,oy); ctx.lineTo(ox+off+a*sc,oy); ctx.lineTo(ox+a*sc,oy+b*sc); ctx.lineTo(ox,oy+b*sc); ctx.closePath();
      ctx.fillStyle='rgba(139,92,246,0.12)'; ctx.fill();
      ctx.strokeStyle='#8b5cf6'; ctx.lineWidth=3; ctx.stroke();
      ctx.fillStyle='#8b5cf6'; ctx.font='bold 14px Nunito,sans-serif';
      ctx.textAlign='center'; ctx.fillText('b='+a, ox+off+a*sc/2, oy+b*sc+20);
      ctx.textAlign='right';   ctx.fillText('h='+b, ox-4, oy+b*sc/2+5);
    }},

  trap:{ name:'Trapezio',
    formula:'A = (B+b)Ã—h Ã· 2 &nbsp;&nbsp; P = B+b+lâ‚+lâ‚‚',
    inv:'B = (2Ã—AÃ·h) âˆ’ b',
    color:'#22c55e', vars:['base magg. (B)','altezza (h)'],
    calc:(B,h)=>{const b=Math.round(B*0.6); return {a:(B+b)*h/2, p:null};},
    draw:(ctx,B,h)=>{
      const b=Math.round(B*0.6);
      const sc=Math.min(222/B, 182/h);
      const off=(B-b)*sc/2, ox=44, oy=30;
      ctx.beginPath(); ctx.moveTo(ox+off,oy); ctx.lineTo(ox+off+b*sc,oy); ctx.lineTo(ox+B*sc,oy+h*sc); ctx.lineTo(ox,oy+h*sc); ctx.closePath();
      ctx.fillStyle='rgba(34,197,94,0.12)'; ctx.fill();
      ctx.strokeStyle='#22c55e'; ctx.lineWidth=3; ctx.stroke();
      ctx.fillStyle='#22c55e'; ctx.font='bold 13px Nunito,sans-serif';
      ctx.textAlign='center';
      ctx.fillText('B='+B, ox+B*sc/2, oy+h*sc+20);
      ctx.fillText('bâ‰ˆ'+b, ox+off+b*sc/2, oy-8);
      ctx.textAlign='right'; ctx.fillText('h='+h, ox-4, oy+h*sc/2+5);
    }},

  sq:{ name:'Quadrato',
    formula:'A = lÂ² &nbsp;&nbsp; P = 4l',
    inv:'l = âˆšA  |  l = P Ã· 4',
    color:'#f59e0b', vars:['lato (l)','lato (l)'],
    calc:(a)=>({a:a*a, p:4*a}),
    draw:(ctx,a)=>{
      const sc=Math.min(182/a, 182/a);
      const ox=44, oy=30;
      ctx.fillStyle='rgba(245,158,11,0.12)'; ctx.fillRect(ox,oy,a*sc,a*sc);
      ctx.strokeStyle='#f59e0b'; ctx.lineWidth=3; ctx.strokeRect(ox,oy,a*sc,a*sc);
      ctx.fillStyle='#f59e0b'; ctx.font='bold 14px Nunito,sans-serif';
      ctx.textAlign='center'; ctx.fillText('l='+a, ox+a*sc/2, oy+a*sc+20);
      ctx.textAlign='right';   ctx.fillText('l='+a, ox-4, oy+a*sc/2+5);
    }},

  rombo:{ name:'Rombo',
    formula:'A = (dâ‚ Ã— dâ‚‚) Ã· 2 &nbsp;&nbsp; P = 4l',
    inv:'dâ‚ = (2Ã—A) Ã· dâ‚‚  |  dâ‚‚ = (2Ã—A) Ã· dâ‚',
    color:'#f43f5e', vars:['diagonale dâ‚','diagonale dâ‚‚'],
    calc:(d1,d2)=>({a:d1*d2/2, p:null}),
    draw:(ctx,d1,d2)=>{
      const sc=Math.min(200/d1, 150/d2);
      const cx=44+d1*sc/2, cy=30+d2*sc/2;
      ctx.beginPath();
      ctx.moveTo(cx, 30);
      ctx.lineTo(44+d1*sc, cy);
      ctx.lineTo(cx, 30+d2*sc);
      ctx.lineTo(44, cy);
      ctx.closePath();
      ctx.fillStyle='rgba(244,63,94,0.12)'; ctx.fill();
      ctx.strokeStyle='#f43f5e'; ctx.lineWidth=3; ctx.stroke();
      // diagonals dashed
      ctx.setLineDash([4,3]); ctx.strokeStyle='#f43f5eaa'; ctx.lineWidth=1.5;
      ctx.beginPath(); ctx.moveTo(44,cy); ctx.lineTo(44+d1*sc,cy); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(cx,30); ctx.lineTo(cx,30+d2*sc); ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle='#f43f5e'; ctx.font='bold 13px Nunito,sans-serif';
      ctx.textAlign='center'; ctx.fillText('dâ‚='+d1, cx, 30+d2*sc+20);
      ctx.textAlign='left';   ctx.fillText('dâ‚‚='+d2, cx+4, cy-4);
    }},

  cerchio:{ name:'Cerchio',
    formula:'A = Ï€ Ã— rÂ² &nbsp;&nbsp; C = 2Ï€r',
    inv:'r = âˆš(AÃ·Ï€)  |  r = CÃ·(2Ï€)',
    color:'#06b6d4', vars:['raggio (r)','raggio (r)'],
    calc:(r)=>({a:Math.PI*r*r, p:2*Math.PI*r}),
    draw:(ctx,r)=>{
      const sc=Math.min(100/r, 100/r);
      const cx=44+r*sc+10, cy=30+r*sc+10;
      ctx.beginPath(); ctx.arc(cx,cy,r*sc,0,Math.PI*2);
      ctx.fillStyle='rgba(6,182,212,0.12)'; ctx.fill();
      ctx.strokeStyle='#06b6d4'; ctx.lineWidth=3; ctx.stroke();
      // radius line
      ctx.strokeStyle='#06b6d4aa'; ctx.lineWidth=2; ctx.setLineDash([4,3]);
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(cx+r*sc,cy); ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle='#06b6d4'; ctx.font='bold 13px Nunito,sans-serif';
      ctx.textAlign='left'; ctx.fillText('r='+r, cx+r*sc/2, cy-6);
      ctx.textAlign='center'; ctx.fillText('âŠ™', cx, cy+5);
    }},
};

let gState = {key:'rect', v1:5, v2:4};
function showGeomShape(pillEl, key) {
  document.querySelectorAll('#geomPills .pill').forEach(p=>p.classList.remove('active'));
  if(pillEl) pillEl.classList.add('active');
  gState.key=key;
  const s=GEOM_SHAPES[key];
  const isSingle = (key==='sq'||key==='cerchio');
  const html = `
    <div class="vb vb-blue">
      <h3>${s.name}</h3>
      <div style="text-align:center;margin:10px 0"><span class="formula formula-blue" style="font-size:15px;padding:10px 18px">${s.formula}</span></div>
      <div style="font-size:13px;color:var(--purple);font-family:var(--font);font-weight:700;margin-bottom:14px;text-align:center">ðŸ” Inversa: ${s.inv}</div>
      <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:flex-start">
        <canvas id="geomCanvas" width="280" height="240" style="flex-shrink:0;max-width:100%;border-radius:14px;background:white;border:2px solid var(--border)"></canvas>
        <div style="flex:1;min-width:130px">
          <div class="slider-row"><label>${s.vars[0]}: <strong id="gv1">${gState.v1}</strong></label>
            <input type="range" min="2" max="8" value="${gState.v1}" oninput="gState.v1=+this.value;document.getElementById('gv1').textContent=this.value;drawGeom()" style="accent-color:${s.color}">
          </div>
          ${!isSingle?`<div class="slider-row"><label>${s.vars[1]}: <strong id="gv2">${gState.v2}</strong></label>
            <input type="range" min="2" max="8" value="${gState.v2}" oninput="gState.v2=+this.value;document.getElementById('gv2').textContent=this.value;drawGeom()" style="accent-color:${s.color}"></div>`:''}
          <div class="geom-result" id="geomResult">A = â€¦</div>
        </div>
      </div>
    </div>`;
  document.getElementById('geomShape').innerHTML=html;
  setTimeout(drawGeom,50);
}
function drawGeom() {
  const s=GEOM_SHAPES[gState.key];
  const c=document.getElementById('geomCanvas');
  if(!c) return;
  const ctx=c.getContext('2d');
  ctx.clearRect(0,0,280,240);
  s.draw(ctx, gState.v1, gState.v2);
  const res = s.calc(gState.v1, gState.v2);
  const area = typeof res === 'object' ? res.a : res;
  const perim = typeof res === 'object' ? res.p : null;
  let txt = `Area = ${area.toFixed(2).replace('.',',')} cmÂ²`;
  if(perim) txt += ` &nbsp;|&nbsp; P = ${perim.toFixed(1).replace('.',',')} cm`;
  if(gState.key==='cerchio') txt = `A = ${area.toFixed(2).replace('.',',')} cmÂ² &nbsp;|&nbsp; C = ${(2*Math.PI*gState.v1).toFixed(2).replace('.',',')} cm`;
  document.getElementById('geomResult').innerHTML = txt;
}

// Pitagora canvas
function drawPita() {
  const a=parseInt(document.getElementById('slPA')?.value||3);
  const b=parseInt(document.getElementById('slPB')?.value||4);
  document.getElementById('pA').textContent=a;
  document.getElementById('pB').textContent=b;
  const c=Math.sqrt(a*a+b*b);
  const canvas=document.getElementById('pitaCanvas');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const W=320,H=260,pad=50,sc=24;
  ctx.clearRect(0,0,W,H);
  const ox=pad, oy=H-pad, px=ox+a*sc, py=oy, qx=ox, qy=oy-b*sc;
  ctx.beginPath(); ctx.moveTo(ox,oy); ctx.lineTo(px,py); ctx.lineTo(qx,qy); ctx.closePath();
  ctx.fillStyle='rgba(139,92,246,0.1)'; ctx.fill();
  [[ox,oy,px,py,'#ef4444',`a=${a}`,(ox+px)/2,oy+20],
   [ox,oy,qx,qy,'#3b82f6',`b=${b}`,ox-22,(oy+qy)/2],
   [px,py,qx,qy,'#8b5cf6',`câ‰ˆ${c.toFixed(2).replace('.',',')}`,(px+qx)/2+18,(py+qy)/2-8]
  ].forEach(([x1,y1,x2,y2,col,lbl,tx,ty])=>{
    ctx.strokeStyle=col; ctx.lineWidth=3; ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke();
    ctx.fillStyle=col; ctx.font='bold 15px Nunito,sans-serif'; ctx.textAlign='center'; ctx.fillText(lbl,tx,ty);
  });
  const sq=12; ctx.strokeStyle='#888'; ctx.lineWidth=1.5; ctx.strokeRect(ox,oy-sq,sq,sq);
  document.getElementById('pitaResult').innerHTML = `${a}Â² + ${b}Â² = ${a*a} + ${b*b} = <strong>${a*a+b*b}</strong> â†’ c = âˆš${a*a+b*b} â‰ˆ <strong>${c.toFixed(2).replace('.',',')}</strong>`;
}

// Statistics
function initRadicali() {
  const row = document.getElementById('sqPerfRow');
  if(!row) return;
  const perfects = [1,4,9,16,25,36,49,64,81,100,121,144,169,196,225];
  row.innerHTML = perfects.map(n => {
    const r = Math.sqrt(n);
    return `<span style="background:#ecfeff;color:#0e7490;border-radius:8px;padding:4px 8px;border:1.5px solid #06b6d4">âˆš${n}=${r}</span>`;
  }).join('');
}

function initStat() {
  const voti=[6,7,8,6,9,7,6,8];
  const row=document.getElementById('votiRow');
  if(!row) return;
  row.innerHTML=voti.map(v=>`<div style="width:46px;height:46px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:var(--font);font-weight:900;font-size:20px;background:var(--yellow-light);border:3px solid var(--yellow);color:#92400e">${v}</div>`).join('');
  const media=(voti.reduce((a,b)=>a+b,0)/voti.length).toFixed(2).replace('.',',');
  const sorted=[...voti].sort((a,b)=>a-b);
  const med=(sorted[3]+sorted[4])/2;
  const freq={}; voti.forEach(v=>freq[v]=(freq[v]||0)+1);
  const moda=Object.entries(freq).sort((a,b)=>b[1]-a[1])[0][0];
  document.getElementById('statCalc').innerHTML=
    `ðŸ“ <strong>Media</strong> = (${voti.join('+')})/8 = ${voti.reduce((a,b)=>a+b,0)}/8 = <span style="color:var(--primary)">${media}</span><br>
     ðŸ” <strong>Moda</strong> = valore piÃ¹ frequente = <span style="color:var(--accent)">${moda}</span> (appare ${freq[moda]} volte)<br>
     ðŸ“ <strong>Mediana</strong> = ordinati: [${sorted.join(',')}] â†’ media dei due centrali = <span style="color:var(--purple)">${med}</span>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATS PAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStats() {
  const topics = [
    {key:'numeri',name:'Numeri Relativi',icon:'Â±',color:'#ef4444'},
    {key:'frazioni',name:'Frazioni',icon:'Â½',color:'#f59e0b'},
    {key:'geometria',name:'Geometria',icon:'ðŸ”·',color:'#3b82f6'},
    {key:'pitagora',name:'Pitagora',icon:'ðŸ“',color:'#8b5cf6'},
    {key:'algebra',name:'Algebra',icon:'ðŸ”¤',color:'#22c55e'},
    {key:'statistica',name:'Statistica',icon:'ðŸ“Š',color:'#f59e0b'},
  ];
  const totalPts = state.points;
  const stars = Math.min(5, Math.floor(totalPts/60));
  document.getElementById('statGrid').innerHTML = `
    <div class="stat-box" style="grid-column:span 2">
      <div class="sv" style="color:var(--primary)">${totalPts}</div>
      <div class="sl">PUNTI TOTALI</div>
      <div class="stars-row">${'â­'.repeat(stars)}${'â˜†'.repeat(5-stars)}</div>
    </div>
    ${topics.map(t=>{
      const p=state.progress[t.key];
      const pct = p.done>0 ? Math.round(p.correct/p.done*100) : 0;
      return `<div class="stat-box">
        <div style="font-size:26px">${t.icon}</div>
        <div class="sv" style="color:${t.color}">${pct}%</div>
        <div class="sl">${t.name}</div>
        <div style="font-size:11px;color:var(--text-light);margin-top:4px">${p.done} risposte</div>
      </div>`;
    }).join('')}
  `;
  document.getElementById('statDetail').innerHTML = `
    <h2>ðŸ† Il tuo percorso</h2>
    <p style="margin-top:10px">Risposte totali: <strong>${Object.values(state.progress).reduce((a,p)=>a+p.done,0)}</strong></p>
    <p>Risposte corrette: <strong style="color:var(--green)">${Object.values(state.progress).reduce((a,p)=>a+p.correct,0)}</strong></p>
    <p style="font-size:14px;color:var(--text-light);margin-top:12px">Continua ad esercitarti â€” ogni errore Ã¨ un passo verso la comprensione! ðŸ§¡</p>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POINTS & HOME UPDATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addPoints(n) {
  state.points += n;
  document.getElementById('ptsBadge').textContent = `â­ ${state.points} pt`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RIPASSO GENERALE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let rpState = {};

function showRipasso() {
  document.querySelectorAll('.page').forEach(el=>el.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(el=>el.classList.remove('active'));
  document.getElementById('pageRipasso').classList.add('active');
  document.getElementById('nav-ripasso').classList.add('active');
  // Mostra start screen
  document.getElementById('ripassoStart').style.display='';
  document.getElementById('ripassoQuiz').style.display='none';
  document.getElementById('ripassoResult').style.display='none';
  // Mostra record se esiste
  const best = localStorage.getItem('rpBest');
  if(best) {
    const b = JSON.parse(best);
    document.getElementById('ripassoBest').textContent = `${b.correct}/${b.total} (${Math.round(b.correct/b.total*100)}%)`;
    document.getElementById('ripassoBestBox').style.display='';
  }
  window.scrollTo(0,0);
}

function startRipasso(n) {
  // Costruisci pool mescolando tutti i quiz
  const topicLabels = {
    numeri:'Â± Numeri', frazioni:'Â½ Frazioni', geometria:'ðŸ”· Geometria',
    pitagora:'ðŸ“ Pitagora', algebra:'ðŸ”¤ Algebra', statistica:'ðŸ“Š Statistica', radicali:'âˆš Radicali'
  };
  let pool = [];
  for(const [topic, qs] of Object.entries(QUIZZES)) {
    qs.forEach(q => pool.push({...q, _topic: topic, _topicLabel: topicLabels[topic]||topic}));
  }
  // Fisher-Yates shuffle
  for(let i=pool.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [pool[i],pool[j]]=[pool[j],pool[i]];
  }
  // Prendi n domande, garantendo varietÃ  di argomenti (max 6 per argomento)
  const selected = [];
  const topicCount = {};
  const maxPerTopic = Math.ceil(n / Object.keys(QUIZZES).length) + 1;
  for(const q of pool) {
    if(selected.length >= n) break;
    const t = q._topic;
    if((topicCount[t]||0) < maxPerTopic) {
      selected.push(q);
      topicCount[t] = (topicCount[t]||0)+1;
    }
  }
  // Se non abbastanza (per via del cap), aggiungine altri
  if(selected.length < n) {
    for(const q of pool) {
      if(selected.length >= n) break;
      if(!selected.includes(q)) selected.push(q);
    }
  }

  rpState = {
    questions: selected,
    total: selected.length,
    current: 0,
    correct: 0,
    answered: false,
    topicResults: {}
  };

  document.getElementById('ripassoStart').style.display='none';
  document.getElementById('ripassoQuiz').style.display='';
  document.getElementById('ripassoResult').style.display='none';
  rpRenderQuestion();
}

function rpRenderQuestion() {
  const { questions, current, total, correct } = rpState;
  const q = questions[current];

  document.getElementById('rpProgress').textContent = `${current+1} / ${total}`;
  document.getElementById('rpScore').textContent = `âœ… ${correct}`;
  document.getElementById('rpTopic').textContent = q._topicLabel;
  document.getElementById('rpBarFill').style.width = `${(current/total)*100}%`;
  document.getElementById('rpQuestion').textContent = q.q;
  document.getElementById('rpHint').style.display='none';
  document.getElementById('rpNext').style.display='none';
  rpState.answered = false;

  // Shuffle opts
  const opts = [...q.opts];
  for(let i=opts.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [opts[i],opts[j]]=[opts[j],opts[i]];
  }

  const container = document.getElementById('rpOpts');
  container.innerHTML = '';
  opts.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.style.cssText = 'width:100%;padding:13px 16px;background:white;border:2px solid var(--border);border-radius:12px;font-family:var(--font);font-weight:700;font-size:15px;cursor:pointer;text-align:left;transition:all 0.2s';
    btn.onclick = () => rpAnswer(opt, btn, q);
    container.appendChild(btn);
  });
}

function rpAnswer(chosen, btn, q) {
  if(rpState.answered) return;
  rpState.answered = true;
  const correct = chosen === q.ans;

  // Update topic results
  const t = q._topic;
  if(!rpState.topicResults[t]) rpState.topicResults[t]={done:0,correct:0,label:q._topicLabel};
  rpState.topicResults[t].done++;
  if(correct) { rpState.topicResults[t].correct++; rpState.correct++; }

  // Style all buttons
  document.querySelectorAll('#rpOpts button').forEach(b => {
    b.disabled = true;
    if(b.textContent === q.ans) {
      b.style.background='#dcfce7'; b.style.borderColor='#22c55e'; b.style.color='#166534';
    } else if(b === btn && !correct) {
      b.style.background='#fee2e2'; b.style.borderColor='#ef4444'; b.style.color='#991b1b';
    }
  });

  // Show hint
  if(q.hint) {
    const h = document.getElementById('rpHint');
    h.textContent = 'ðŸ’¡ ' + q.hint;
    h.style.display='';
  }

  // Update score display
  document.getElementById('rpScore').textContent = `âœ… ${rpState.correct}`;

  // Show next or finish
  const nextBtn = document.getElementById('rpNext');
  nextBtn.style.display='';
  const isLast = rpState.current >= rpState.total - 1;
  nextBtn.textContent = isLast ? 'ðŸ“Š Vedi risultato' : 'Prossima â†’';
}

function rpNextQuestion() {
  rpState.current++;
  if(rpState.current >= rpState.total) {
    rpShowResult();
  } else {
    rpRenderQuestion();
  }
}

function rpShowResult() {
  document.getElementById('ripassoQuiz').style.display='none';
  document.getElementById('ripassoResult').style.display='';

  const { correct, total, topicResults } = rpState;
  const pct = Math.round(correct/total*100);

  let emoji='ðŸŽ‰', title='', sub='';
  if(pct>=90){ emoji='ðŸ†'; title='Eccezionale!'; sub='Sei davvero preparato su tutto. Ottimo lavoro!'; }
  else if(pct>=75){ emoji='ðŸ˜„'; title='Molto bene!'; sub='Risultato ottimo. Qualche piccola lacuna da ripassare.'; }
  else if(pct>=60){ emoji='ðŸ‘'; title='Bene!'; sub='Buona base. Ripassare gli argomenti dove hai sbagliato.'; }
  else if(pct>=40){ emoji='ðŸ“š'; title='Continua a studiare'; sub='Ci sono argomenti da rivedere. Non mollare!'; }
  else { emoji='ðŸ’ª'; title='Tanta strada da fare'; sub='Riparti dalle lezioni degli argomenti piÃ¹ difficili.'; }

  document.getElementById('rpResultEmoji').textContent=emoji;
  document.getElementById('rpResultTitle').textContent=`${title} â€” ${correct}/${total} (${pct}%)`;
  document.getElementById('rpResultSub').textContent=sub;

  // Breakdown by topic
  let html2='';
  for(const [,tr] of Object.entries(topicResults)) {
    const tp = Math.round(tr.correct/tr.done*100);
    const col = tp>=75?'#22c55e':tp>=50?'#f59e0b':'#ef4444';
    html2+=`<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;font-family:var(--font)">
      <span style="font-weight:800;font-size:13px;min-width:110px">${tr.label}</span>
      <div style="flex:1;height:10px;background:var(--border);border-radius:5px;overflow:hidden">
        <div style="height:100%;background:${col};border-radius:5px;width:${tp}%;transition:width 0.5s"></div>
      </div>
      <span style="font-weight:800;font-size:13px;color:${col};min-width:40px;text-align:right">${tr.correct}/${tr.done}</span>
    </div>`;
  }
  document.getElementById('rpResultByTopic').innerHTML=html2;

  // Salva record
  try {
    const best = JSON.parse(localStorage.getItem('rpBest')||'null');
    if(!best || pct > Math.round(best.correct/best.total*100)) {
      localStorage.setItem('rpBest', JSON.stringify({correct,total}));
    }
  } catch(e){}

  window.scrollTo(0,0);
}

function updateHome() {
  const tots = {numeri:10,frazioni:10,geometria:22,pitagora:10,algebra:10,statistica:10,radicali:15};
  Object.keys(tots).forEach(k=>{
    const p=state.progress[k];
    const fill=document.getElementById('fill-'+k);
    if(fill) fill.style.width = Math.min(100, p.done/tots[k]*100)+'%';
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACCESSIBILITY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleA(cls, btn) {
  document.body.classList.toggle(cls);
  btn.classList.toggle('on');
}
let soundOn=false;
function toggleSound(btn) {
  soundOn=!soundOn;
  btn.classList.toggle('on', soundOn);
  btn.textContent = soundOn?'ðŸ”Š Audio Attivo':'ðŸ”‡ Audio OFF';
}
function speak(t) {
  if(!soundOn) return;
  try{ const u=new SpeechSynthesisUtterance(t);u.lang='it-IT';u.rate=0.9;speechSynthesis.speak(u); }catch(e){}
}
function playCorrect() {
  if(!soundOn) return;
  try{ const ctx=new AudioContext(),o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);o.frequency.value=660;o.type='sine';
    g.gain.setValueAtTime(0.3,ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.3);
    o.start();o.stop(ctx.currentTime+0.3);
    setTimeout(()=>{ const o2=ctx.createOscillator(),g2=ctx.createGain();o2.connect(g2);g2.connect(ctx.destination);
      o2.frequency.value=880;g2.gain.setValueAtTime(0.25,ctx.currentTime);g2.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.25);
      o2.start();o2.stop(ctx.currentTime+0.25); },150);
  }catch(e){}
}
function playWrong() {
  if(!soundOn) return;
  try{ const ctx=new AudioContext(),o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);o.frequency.value=220;o.type='sawtooth';
    g.gain.setValueAtTime(0.2,ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.4);
    o.start();o.stop(ctx.currentTime+0.4);
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CALCULATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let cExpr='', cPrevRes=false;
function ci(v) {
  const d=document.getElementById('calcDisp');
  if(v==='C'){cExpr='';d.textContent='0';return;}
  if(v==='='){
    try{
      const e=cExpr.replace(/Ã—/g,'*').replace(/Ã·/g,'/').replace(/âˆ’/g,'-');
      const r=Function('"use strict";return('+e+')')();
      d.textContent=parseFloat(r.toFixed(8));
      cExpr=String(parseFloat(r.toFixed(8)));
      cPrevRes=true;
    }catch(e){d.textContent='Err';cExpr='';}
    return;
  }
  if(v==='Â±'){cExpr=cExpr?String(-parseFloat(cExpr)):cExpr;d.textContent=(cExpr||'0').replace('.',',');return;}
  if(v==='âˆš'){
    const n=parseFloat(cExpr);
    if(isNaN(n)||n<0){d.textContent='Errore: negativo';cExpr='';return;}
    const r=Math.sqrt(n);
    cExpr=String(parseFloat(r.toFixed(8)));
    d.textContent='âˆš'+n+' = '+r.toFixed(4).replace('.',',');
    cPrevRes=true; return;
  }
  if(cPrevRes&&'0123456789'.includes(v)){cExpr='';cPrevRes=false;}
  cExpr+=v; d.textContent=cExpr;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PITAGORA TABLE BUILD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const t=document.getElementById('pitaTable');
  let h='<tr><th>Ã—</th>';
  for(let i=1;i<=10;i++) h+=`<th>${i}</th>`;
  h+='</tr>';
  for(let r=1;r<=10;r++){
    h+=`<tr><th>${r}</th>`;
    for(let c=1;c<=10;c++) h+=`<td class="${r===c?'diag':''}">${r*c}</td>`;
    h+='</tr>';
  }
  t.innerHTML=h;
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FORMULE SHEET BUILD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const defs=[
    {icon:'â–­',name:'Rettangolo',    f:'A = bÃ—h',          p:'P = 2(b+h)',   inv:'b = AÃ·h | h = AÃ·b | b = P/2âˆ’h'},
    {icon:'â– ',name:'Quadrato',      f:'A = lÂ²',           p:'P = 4l',       inv:'l = âˆšA | l = PÃ·4'},
    {icon:'â–³',name:'Triangolo',     f:'A = (bÃ—h) Ã· 2',   p:'P = a+b+c',    inv:'b = 2AÃ·h | h = 2AÃ·b'},
    {icon:'â¬§',name:'Parallelogramma',f:'A = bÃ—h',         p:'P = 2(b+l)',   inv:'b = AÃ·h | h = AÃ·b'},
    {icon:'âŒ‚',name:'Trapezio',      f:'A = (B+b)Ã—h Ã· 2', p:'P = B+b+lâ‚+lâ‚‚',inv:'B = (2AÃ·h)âˆ’b'},
    {icon:'â—‡',name:'Rombo',         f:'A = (dâ‚Ã—dâ‚‚) Ã· 2', p:'P = 4l',       inv:'dâ‚ = 2AÃ·dâ‚‚ | dâ‚‚ = 2AÃ·dâ‚'},
    {icon:'â­•',name:'Cerchio',       f:'A = Ï€Ã—rÂ²',         p:'C = 2Ï€r',      inv:'r = âˆš(AÃ·Ï€) | r = CÃ·(2Ï€)'},
    {icon:'ðŸ“',name:'Pitagora',      f:'aÂ²+bÂ²=cÂ²',         p:'â€”',            inv:'b = âˆš(cÂ²âˆ’aÂ²)'},
    {icon:'âˆš', name:'Potenze',        f:'aáµÃ—aâ¿=a^(m+n)',   p:'aáµÃ·aâ¿=a^(mâˆ’n)', inv:'(aáµ)â¿=a^(mÃ—n) | aâ°=1'},
    {icon:'âˆ›', name:'Radicali',       f:'âˆš(aÃ—b)=âˆšaÃ—âˆšb',    p:'âˆša=a^(1/2)',    inv:'âˆš(nÂ²Ã—a)=nâˆša'},
  ];
  document.getElementById('formuleList').innerHTML=defs.map(d=>`
    <div class="form-row">
      <div class="form-icon">${d.icon}</div>
      <div class="form-content">
        <div class="name">${d.name}</div>
        <div class="f">${d.f} &nbsp;<span style="color:var(--accent);font-size:13px">${d.p}</span></div>
        <div class="inv">â†© ${d.inv}</div>
      </div>
    </div>`).join('');
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(id){document.getElementById(id).classList.add('show');if(id==='mTav')setTimeout(renderTavole,80);if(id==='mPrim')setTimeout(renderPrimi,80);}
function closeModal(id){document.getElementById(id).classList.remove('show');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SAVE / LOAD PROGRESS (localStorage)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveProgress() {
  try{ localStorage.setItem('mathup_progress', JSON.stringify({pts:state.points, prog:state.progress})); }catch(e){}
}
function loadProgress() {
  try{
    const d=JSON.parse(localStorage.getItem('mathup_progress'));
    if(d){ state.points=d.pts||0; Object.assign(state.progress,d.prog||{}); }
  }catch(e){}
  document.getElementById('ptsBadge').textContent=`â­ ${state.points} pt`;
  updateHome();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NUMERI PRIMI (Crivello di Eratostene)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _primes = null;
function buildPrimes() {
  if(_primes) return _primes;
  const N = 10000;
  const sieve = new Uint8Array(N+1).fill(1);
  sieve[0]=sieve[1]=0;
  for(let i=2;i*i<=N;i++) if(sieve[i]) for(let j=i*i;j<=N;j+=i) sieve[j]=0;
  _primes=[];
  for(let i=2;i<=N;i++) if(sieve[i]) _primes.push(i);
  return _primes;
}
function renderPrimi() {
  const primes = buildPrimes();
  const container = document.getElementById('primList');
  if(!container) return;
  // Render colored spans grouped by hundreds
  let html2 = '';
  let curHundred = -1;
  for(const p of primes) {
    const h = Math.floor(p/100);
    if(h !== curHundred) {
      if(curHundred >= 0) html2 += '</div>';
      html2 += `<div style="margin-bottom:6px"><span style="font-family:var(--font);font-size:11px;font-weight:800;color:var(--text-light);display:inline-block;width:50px">${h*100}s:</span>`;
      curHundred = h;
    }
    html2 += `<span style="display:inline-block;background:#eff6ff;color:#1d4ed8;border-radius:6px;padding:1px 6px;margin:1px;font-family:var(--font);font-weight:800;font-size:13px">${p}</span>`;
  }
  html2 += '</div>';
  container.innerHTML = html2;
  document.querySelector('#mPrim h3').textContent = `ðŸ”µ Numeri Primi < 10 000 (${primes.length} totali)`;
}
function checkPrimo(val) {
  const n = parseInt(val);
  const result = document.getElementById('primSearchResult');
  if(!result) return;
  if(isNaN(n) || n < 2) { result.textContent=''; return; }
  const primes = buildPrimes();
  if(n > 10000) { result.textContent='âš ï¸ Max 9999'; result.style.color='var(--red)'; return; }
  const isPrime = primes.includes(n);
  result.textContent = isPrime ? `âœ… ${n} Ã¨ PRIMO!` : `âŒ ${n} non Ã¨ primo`;
  result.style.color = isPrime ? 'var(--green)' : 'var(--red)';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TAVOLE NUMERICHE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTavole() {
  const from = Math.max(1, parseInt(document.getElementById('tavFrom').value)||1);
  const to   = Math.min(1000, parseInt(document.getElementById('tavTo').value)||20);
  if(from >= to) { alert('Il valore "Da" deve essere minore di "A"'); return; }
  if(to - from > 200) { alert('Max 200 righe alla volta per performance'); return; }
  const tbody = document.getElementById('tavBody');
  let rows = '';
  for(let n = from; n <= to; n++) {
    const sq  = n * n;
    const cu  = n * n * n;
    const sqr = Math.sqrt(n).toFixed(4).replace('.',',');
    const cbr = Math.cbrt(n).toFixed(4).replace('.',',');
    const bg  = n % 2 === 0 ? 'background:#f8fafc' : 'background:white';
    rows += `<tr style="${bg}">
      <td style="padding:6px 10px;text-align:right;font-weight:800;color:var(--primary)">${n}</td>
      <td style="padding:6px 10px;text-align:right;font-weight:700">${sq.toLocaleString('it-IT')}</td>
      <td style="padding:6px 10px;text-align:right;font-weight:700">${cu.toLocaleString('it-IT')}</td>
      <td style="padding:6px 10px;text-align:right;font-weight:700;color:#059669">${sqr}</td>
      <td style="padding:6px 10px;text-align:right;font-weight:700;color:#7c3aed">${cbr}</td>
    </tr>`;
  }
  tbody.innerHTML = rows;
}
// Auto-render on modal open â€” patch openModal
(function(){
  const orig = window.openModal || function(){};
  window.openModal = function(id) {
    if(typeof orig === 'function') orig(id);
    if(id === 'mTav') { setTimeout(renderTavole, 80); }
  };
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PWA INSTALL â€” iOS Safari + Android Chrome
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const isIos = /iphone|ipad|ipod/i.test(navigator.userAgent);
const isInStandaloneMode = () =>
  ('standalone' in navigator && navigator.standalone) ||
  window.matchMedia('(display-mode: standalone)').matches;

// iOS: show guide after 3 seconds if not already installed
if (isIos && !isInStandaloneMode()) {
  setTimeout(() => {
    openModal('mIos');
  }, 3000);
}

// Android / Chrome: native install prompt
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  installPrompt = e;
  // Show banner after small delay
  setTimeout(() => {
    document.getElementById('install-banner').classList.add('show');
  }, 1500);
});

document.getElementById('installBtn').onclick = async () => {
  if (!installPrompt) return;
  installPrompt.prompt();
  const r = await installPrompt.userChoice;
  document.getElementById('install-banner').classList.remove('show');
  if (r.outcome === 'accepted') installPrompt = null;
};

// If already installed, hide banner
window.addEventListener('appinstalled', () => {
  document.getElementById('install-banner').classList.remove('show');
  installPrompt = null;
});

// SW registered inline above

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('load', () => {
  loadProgress();
  setTimeout(()=>{
    const s=document.getElementById('splash');
    s.style.opacity='0';
    setTimeout(()=>s.style.display='none',500);
  }, 1400);
});
</script>
</body>
</html>
